# November 2, 2016 Report

Number of commits: 226

## Compilation time

* github.com/boltdb/bolt/cmd/bolt: from 509.98137ms to 509.38386ms, -0.12%
* github.com/junegunn/fzf/src/fzf: from 1.005060489s to 1.08748428s, +8.20%

## Binary size:

* github.com/boltdb/bolt/cmd/bolt: from 2538596 to 2492280, -1.82%
* github.com/junegunn/fzf/src/fzf: from 3088128 to 3042256, -1.49%

## Highlights: 

* [all: freeze net/rpc and reword the 'frozen' message in other frozen packages](https://github.com/golang/go/commit/f9027d61ab48154e4cb29c50e356a3f462840e01)
* [crypto/tls: add CloseWrite method to Conn](https://github.com/golang/go/commit/829aa6732a47db75dbb649837fa888030659ccf9)
* [spec: add new language for alias declarations](https://github.com/golang/go/commit/aff37662d1f70f2bf9e47b4f962e85521e7c18d1)
* [runtime: Profile goroutines holding contended mutexes.](https://github.com/golang/go/commit/ca922b6d363b6ca47822188dcbc5b92d912c7a4b)
* [bytes, strings: optimize for ASCII sets](https://github.com/golang/go/commit/9a8c69539cbd052e2c4b55496d72ec8407c0af52)
* [net: only remove Unix domain socket file on the first call to Close](https://github.com/golang/go/commit/13558c41ffa29d0af80e7e06d08af8eb0f0055fb)
* [net: add (*UnixListener).SetUnlinkOnClose](https://github.com/golang/go/commit/eb88b3eefa113f67e7cf72dfd085f65bbd125179)
* [runtime/pprof: write profiles in protobuf format.](https://github.com/golang/go/commit/b33030a72754cb55d6ec137e79facacb398c9be4)
* [net/http: add Server.Close & Server.Shutdown for forced & graceful shutdown](https://github.com/golang/go/commit/53fc330e2d154443acf3d01e0d68bae22b2b7804)
* [bytes,strings: use IndexByte more often in Index on AMD64](https://github.com/golang/go/commit/f31492ffe7d68e84ec0ba6e870d174ab48e6397c)

## GIT Log

```
commit 47c1715ba5ea7d5ecc9eff846f448d8a3b62808d
Author: David Crawshaw <crawshaw@golang.org>
Date:   Wed Nov 2 09:10:29 2016 -0400

    runtime: address comments from CL 32357
    
    Change-Id: I174d7307bfdd8ec57bb4266dab8569fd2234abb4
    Reviewed-on: https://go-review.googlesource.com/32610
    Reviewed-by: Austin Clements <austin@google.com>
    Run-TryBot: David Crawshaw <crawshaw@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 7bf0fc9fc392acee87bcdb4b1e474e342cb70f92
Author: Ian Lance Taylor <iant@golang.org>
Date:   Tue Nov 1 12:06:22 2016 -0700

    cmd/go: use cgo -srcdir when using SWIG
    
    SWIG generates cgo input files in the work directory. When those files
    are passed directly to cgo, cgo generates long file names that include
    the object directory (with slashes replaced by underscores). Instead,
    use cgo's new -srcdir option to give it short file names.
    
    When using both SWIG and cgo, copy the cgo files into the object
    directory first.
    
    Use a shorter object file name when compiling the C file generated by
    SWIG.
    
    Fixes #17070.
    
    Change-Id: Ic558603f1731636d9999f3130ad0224b24bd7dcb
    Reviewed-on: https://go-review.googlesource.com/32485
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: David Crawshaw <crawshaw@golang.org>

commit e22b5efb36e5977590d760c98db9f3fabaea7202
Author: Alex Brainman <alex.brainman@gmail.com>
Date:   Sat Oct 29 18:37:49 2016 +1100

    net: implement Buffers on windows
    
    Updates #13451
    
    Change-Id: I2c3c66d9532c16e616c476e2afe31b3ddc0a8d79
    Reviewed-on: https://go-review.googlesource.com/32371
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>

commit c57a443e8777de0f34444dd512fbcb099e7b3e29
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Nov 1 16:44:18 2016 -0700

    doc: update go1.8.txt
    
    Automated update after manual classification using x/build/cmd/writenotes.
    
    Change-Id: Ie92f501d301c1e2245954439da197812c09c1684
    Reviewed-on: https://go-review.googlesource.com/32570
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 689947d5652e51980fbfc7b350871fe2baa06a74
Author: Ian Lance Taylor <iant@golang.org>
Date:   Tue Nov 1 14:13:34 2016 -0700

    cmd/cgo: only record typedef name for pointer to struct
    
    In a function argument, we handle a typedef for a pointer specially,
    using the pointer type rather than the typedef, to permit the Go calls
    to match the laxer type conversions permitted in C. We record the
    typedef so that we use that type in the C code, in case it has a special
    attribute. However, using the typedef is wrong when using a pointer to a
    basic type, because the C code may sometimes use the typedef and
    sometimes not, and using the typedef in all cases will cause incorrect
    type errors on the Go side. Fortunately we only really need to use the
    typedef when pointing to a struct/union/class, and in such a case
    confusion is unlikely.
    
    Fixes #17723.
    
    Change-Id: Id2eaeb156faeaf2e8eb9cf0b8f95b44caf8cfbd2
    Reviewed-on: https://go-review.googlesource.com/32536
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: David Crawshaw <crawshaw@golang.org>

commit 3be166dc70bf3539539bc6762aff9660c3dbf229
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Tue Nov 1 15:33:40 2016 -0700

    cmd/compile: get rid of unused Name.Method field
    
    It's never set anywhere, and even if it was, it would just Fatalf.
    
    Change-Id: I84ade6d2068c623a8c85f84d8cdce38984996ddd
    Reviewed-on: https://go-review.googlesource.com/32489
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit c3e0dc23fbca3ad168502f688e7c3f1882f62b73
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Nov 1 14:46:59 2016 -0700

    go/importer: handle multiple imports of the same object
    
    Before aliases, and because we chose a simple export format for them,
    a package may now export the same object more than once if there are
    multiple exported aliases referring to that object. The go/importer
    made the assumption this couldn't happen. Adjust it.
    
    Fixes #17726.
    
    Change-Id: Ibb9fc669a8748200b45ad78934d7453e5a5aad82
    Reviewed-on: https://go-review.googlesource.com/32538
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Robert Griesemer <gri@golang.org>

commit 012fec3821d6d01b69a563125fcb7ae49186be81
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Nov 1 15:15:11 2016 -0700

    cmd/compile/internal/syntax: don't depend on hardwired $GOROOT name
    
    Fixes #17697.
    
    Change-Id: I3c47e139b09bde81566e29a1ac0ec8c58d55a34a
    Reviewed-on: https://go-review.googlesource.com/32539
    Run-TryBot: Robert Griesemer <gri@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 7c7349c9e9217d7bb22f41eaa658bbba8716bad6
Author: Ian Lance Taylor <iant@golang.org>
Date:   Tue Nov 1 13:04:56 2016 -0700

    cmd/go: remove _cgo_flags from gccgo archive built using SWIG
    
    Since SWIG uses cgo, when using SWIG with gccgo, the go tool will add a
    _cgo_flags file to the package archive, just as it does with cgo. We
    need to remove that file from the archive passed to the linker, just as
    we do with cgo.
    
    Change-Id: I5ef4fea92eec419f870fbf6f678691d15901ee6c
    Reviewed-on: https://go-review.googlesource.com/32535
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Michael Hudson-Doyle <michael.hudson@canonical.com>

commit 4e584c52036fb2a572fab466e2a291fb695da882
Author: Michael Hudson-Doyle <michael.hudson@canonical.com>
Date:   Fri Oct 28 15:08:28 2016 +1300

    cmd/compile: mark go.itab.* symbols local earlier
    
    This feels a bit like a layering violation, but as the bug report shows
    it is sometimes necessary.
    
    Fixes #17642
    
    Change-Id: I4ba060bb1ce73a527ce276e5a769c44692b50016
    Reviewed-on: https://go-review.googlesource.com/32236
    Run-TryBot: Michael Hudson-Doyle <michael.hudson@canonical.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Crawshaw <crawshaw@golang.org>

commit d0e408334be22158fbf58a4d02789a48f5cb911e
Author: David Crawshaw <crawshaw@golang.org>
Date:   Sun Oct 30 23:53:09 2016 -0400

    cmd/link: support plugins with no exported symbols
    
    A plugin with no exported symbols is still potentially very useful.
    Its init functions are called on load, and it so it can have visible
    side effects.
    
    Fixes #17681
    
    Change-Id: Icdca31f48e5ab13c99020a2ef724f3de47dcd74b
    Reviewed-on: https://go-review.googlesource.com/32437
    Run-TryBot: David Crawshaw <crawshaw@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit e22c79660d96187b672a92622d171066a0d5c5c2
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Nov 1 10:38:24 2016 -0700

    go/types: handle imported aliases
    
    When we lookup a qualified identifier, we need to unpack
    an alias. Do this in all places, not just one. Duh!
    
    Fixes #17716.
    For #17592.
    
    Change-Id: I58d57b17cc635d0408b370f109c719c16757fd8e
    Reviewed-on: https://go-review.googlesource.com/32534
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 34c480afa89a4efa917f30592d8c095dbaf7612e
Author: David Crawshaw <crawshaw@golang.org>
Date:   Tue Nov 1 15:28:55 2016 -0400

    runtime: resolve type offsets using source module
    
    The runtime.typeEquals function is used during typelinksinit to
    determine the canonical set of *_type values to use throughout the
    runtime. As such, it is run against non-canonical *_type values, that
    is, types from modules that are duplicates of a type from another
    module that was loaded earlier in the program life.
    
    These non-canonical *_type values sometimes contain pointers. These
    pointers are pointing to position-independent data, and so they are set
    by ld.so using dynamic relocations when the module is loaded. As such,
    the pointer can point to the equivalent memory from a previous module.
    
    This means if typesEqual follows a pointer inside a *_type, it can end
    up at a piece of memory from another module. If it reads a typeOff or
    nameOff from that memory and attempts to resolve it against the
    non-canonical *_type from the later module, it will end up with a
    reference to junk memory.
    
    Instead, resolve against the pointer the offset was read from, so the
    data is valid.
    
    Fixes #17709.
    Should no longer matter after #17724 is resolved in a later Go.
    
    Change-Id: Ie88b151a3407d82ac030a97b5b6a19fc781901cb
    Reviewed-on: https://go-review.googlesource.com/32513
    Run-TryBot: David Crawshaw <crawshaw@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

commit 3f1ed245510d21ad021ea96da7bbd37ec2aca9ed
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Tue Nov 1 12:27:26 2016 -0700

    cmd/compile/internal/syntax: avoid deadlock
    
    When the err from ReadFile is non-nil, we call t.Fatal(err).
    Switch t.Fatal to t.Error + return.
    ensure that close(results) happens on that code path as well.
    
    Updates #17697.
    
    Change-Id: Ifaacf27a76c175446d642086ff32f4386428080d
    Reviewed-on: https://go-review.googlesource.com/32486
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    Reviewed-by: Robert Griesemer <gri@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 84803f3da1b3921a6eacec435d97d5b9e40fe947
Author: Ian Lance Taylor <iant@golang.org>
Date:   Tue Nov 1 10:24:06 2016 -0700

    runtime: treat SIGSTOP on Solaris as we do on other systems
    
    This makes no practical difference, as SIGSTOP can not be caught, but
    may as well be consistent.
    
    Change-Id: I3efbbf092388bb3f6dccc94cf703c5d94d35f6a1
    Reviewed-on: https://go-review.googlesource.com/32533
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 2c5bce1cfa242f27ffece3d30e8b851e3e923be2
Author: Ian Lance Taylor <iant@golang.org>
Date:   Sun Oct 30 11:56:19 2016 -0400

    time: simplify: tell people to not use == with Time values
    
    Change-Id: I49952f89b04f41109bb6591c6f025971d9880123
    Reviewed-on: https://go-review.googlesource.com/32411
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: David Symonds <dsymonds@golang.org>

commit d89ab1398eef9a3f08db2a49ff3cbe158001474d
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Nov 1 17:40:07 2016 +0000

    net/http: make Transport reject URLs with bogus ports with non-digits
    
    Fixes #14353
    
    Change-Id: I9cb5a5192ecdae37c100969395ed6a1564b8d34e
    Reviewed-on: https://go-review.googlesource.com/32482
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Martin Möhrmann <martisch@uos.de>

commit f31492ffe7d68e84ec0ba6e870d174ab48e6397c
Author: Ilya Tocar <ilya.tocar@intel.com>
Date:   Fri Oct 21 23:23:48 2016 +0300

    bytes,strings: use IndexByte more often in Index on AMD64
    
    IndexByte+compare is faster than indexShortStr in good case, when
    first byte is rare, but is more costly in bad cases.
    Start with IndexByte and switch to indexShortStr if we encounter
    false positives more often than once per 8 bytes.
    
    Benchmark changes for package bytes:
    
    IndexRune/4K-8                    416ns ± 0%       86ns ± 0%    -79.24%        (p=0.000 n=10+10)
    IndexRune/4M-8                    413µs ± 0%      100µs ± 1%    -75.88%        (p=0.000 n=10+10)
    IndexRune/64M-8                  6.73ms ± 0%     2.86ms ± 1%    -57.49%        (p=0.000 n=10+10)
    Index/10-8                       8.45ns ± 0%     8.96ns ± 0%     +6.04%         (p=0.000 n=9+10)
    Index/32-8                       9.64ns ± 0%     9.51ns ± 0%     -1.30%          (p=0.000 n=8+9)
    Index/4K-8                       2.11µs ± 0%     2.12µs ± 0%     +0.26%        (p=0.000 n=10+10)
    Index/4M-8                       3.60ms ± 5%     3.59ms ± 7%       ~            (p=0.497 n=9+10)
    Index/64M-8                      57.1ms ± 3%     58.7ms ± 5%       ~            (p=0.113 n=9+10)
    IndexEasy/10-8                   7.10ns ± 1%     7.71ns ± 1%     +8.60%        (p=0.000 n=10+10)
    IndexEasy/32-8                   9.29ns ± 1%     9.22ns ± 0%     -0.75%         (p=0.000 n=9+10)
    IndexEasy/4K-8                   1.06µs ± 0%     0.08µs ± 0%    -92.18%        (p=0.000 n=10+10)
    IndexEasy/4M-8                   1.07ms ± 0%     0.10ms ± 1%    -90.74%         (p=0.000 n=9+10)
    IndexEasy/64M-8                  17.3ms ± 0%      2.8ms ± 1%    -83.76%         (p=0.000 n=10+9)
    
    IndexRune/4K-8                 9.84GB/s ± 0%  47.42GB/s ± 0%   +381.85%         (p=0.000 n=8+10)
    IndexRune/4M-8                 10.1GB/s ± 0%   42.1GB/s ± 1%   +314.56%        (p=0.000 n=10+10)
    IndexRune/64M-8                10.0GB/s ± 0%   23.4GB/s ± 1%   +135.25%        (p=0.000 n=10+10)
    Index/10-8                     1.18GB/s ± 0%   1.12GB/s ± 0%     -5.67%         (p=0.000 n=10+9)
    Index/32-8                     3.32GB/s ± 0%   3.36GB/s ± 0%     +1.27%         (p=0.000 n=10+9)
    Index/4K-8                     1.94GB/s ± 0%   1.93GB/s ± 0%     -0.25%         (p=0.000 n=10+9)
    Index/4M-8                     1.17GB/s ± 5%   1.17GB/s ± 7%       ~            (p=0.497 n=9+10)
    Index/64M-8                    1.17GB/s ± 3%   1.15GB/s ± 6%       ~            (p=0.113 n=9+10)
    IndexEasy/10-8                 1.41GB/s ± 1%   1.30GB/s ± 1%     -7.90%        (p=0.000 n=10+10)
    IndexEasy/32-8                 3.45GB/s ± 1%   3.47GB/s ± 0%     +0.73%         (p=0.000 n=9+10)
    IndexEasy/4K-8                 3.84GB/s ± 0%  49.16GB/s ± 0%  +1178.78%         (p=0.000 n=9+10)
    IndexEasy/4M-8                 3.91GB/s ± 0%  42.19GB/s ± 1%   +980.37%         (p=0.000 n=9+10)
    IndexEasy/64M-8                3.88GB/s ± 0%  23.91GB/s ± 1%   +515.76%         (p=0.000 n=10+9)
    
    No significant changes in strings.
    
    In regexp I see:
    
    Match/Easy0/32-8                 536MB/s ± 1%   540MB/s ± 1%    +0.75%         (p=0.001 n=9+10)
    Match/Easy0/1K-8                1.62GB/s ± 0%  4.42GB/s ± 1%  +172.48%        (p=0.000 n=10+10)
    Match/Easy0/32K-8               1.87GB/s ± 0%  9.07GB/s ± 1%  +384.24%         (p=0.000 n=7+10)
    Match/Easy0/1M-8                1.90GB/s ± 0%  4.83GB/s ± 0%  +154.56%         (p=0.000 n=8+10)
    Match/Easy0/32M-8               1.90GB/s ± 0%  4.53GB/s ± 0%  +138.62%         (p=0.000 n=7+10)
    
    Compared to in 1.7:
    
    Match/Easy0/32-8                  59.5ns ± 0%    59.2ns ± 1%   -0.45%         (p=0.008 n=9+10)
    Match/Easy0/1K-8                   226ns ± 1%     231ns ± 1%   +2.30%        (p=0.000 n=10+10)
    Match/Easy0/32K-8                 3.73µs ± 2%    3.61µs ± 1%   -3.12%        (p=0.000 n=10+10)
    Match/Easy0/1M-8                   206µs ± 1%     217µs ± 0%   +5.34%        (p=0.000 n=10+10)
    Match/Easy0/32M-8                 7.03ms ± 1%    7.40ms ± 0%   +5.23%        (p=0.000 n=10+10)
    
    Fixes #17456
    
    Change-Id: I38b2fabcaed7119cc4bf37007ba7bfe7504c8f9f
    Reviewed-on: https://go-review.googlesource.com/31690
    Run-TryBot: Ilya Tocar <ilya.tocar@intel.com>
    Reviewed-by: Keith Randall <khr@golang.org>

commit 655a3b5a55a641962f4ff875490f90af8a2d7ea0
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Nov 1 18:13:54 2016 +0000

    strings: ignore allocation test in cover mode
    
    Fixes #17699
    
    Change-Id: I7ea29a3fc2ca13d9d7e3044cbb8ea22e3435d423
    Reviewed-on: https://go-review.googlesource.com/32484
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>

commit daf3f082648274b0da7264bcc4794ca0dd4b999d
Author: Rob Pike <r@golang.org>
Date:   Tue Nov 1 11:01:39 2016 -0700

    testing: add a method testing.CoverMode
    
    This makes it possible to avoid tests where coverage affects the test
    results by skipping them (or otherwise adjusting them) when coverage
    is enabled.
    
    Update #17699
    
    Change-Id: Ifcc36cfcd88ebd677890e82ba80ee3d696ed3d7c
    Reviewed-on: https://go-review.googlesource.com/32483
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit b06c93e45b7b03a5d670250ff35e42d62aface82
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Nov 1 17:12:48 2016 +0000

    net/http: add Transport.ProxyConnectHeader to control headers to proxies
    
    Fixes #13290
    
    Change-Id: I0f7e7683d86db501cbedb6a0b7349ceb0769701c
    Reviewed-on: https://go-review.googlesource.com/32481
    Reviewed-by: Martin Möhrmann <martisch@uos.de>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 8380de416bbb3550de902374b7626e569060a712
Author: Bryan C. Mills <bcmills@google.com>
Date:   Thu Oct 27 17:36:39 2016 -0400

    runtime: align stack pointer in sigfwd
    
    sigfwd calls an arbitrary C signal handler function.  The System V ABI
    for x86_64 (and the most recent revision of the ABI for i386) requires
    the stack to be 16-byte aligned.
    
    Fixes: #17641
    
    Change-Id: I77f53d4a8c29c1b0fe8cfbcc8d5381c4e6f75a6b
    Reviewed-on: https://go-review.googlesource.com/32107
    Run-TryBot: Bryan Mills <bcmills@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit b2c54afe1451f93e1fbbad257a151d8425cd308d
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Nov 1 15:24:11 2016 +0000

    net/http, net/http/httptest: make http2's TrailerPrefix work for http1
    
    Go's http1 implementation originally had a mechanism to send HTTP
    trailers based on pre-declaring the trailer keys whose values you'd
    later let after the header was written.
    
    http2 copied the same mechanism, but it was found to be unsufficient
    for gRPC's wire protocol. A second trailer mechanism was added later
    (but only to http2) for handlers that want to send a trailer without
    knowing in advance they'd need to.
    
    Copy the same mechanism back to http1 and document it.
    
    Fixes #15754
    
    Change-Id: I8c40d55e28b0e5b7087d3d1a904a392c56ee1f9b
    Reviewed-on: https://go-review.googlesource.com/32479
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 3c2f607274b2284826ea887fa9d2ef62817df608
Author: Lynn Boger <laboger@linux.vnet.ibm.com>
Date:   Tue Nov 1 10:43:34 2016 -0500

    cmd/vendor/golang.org/x/arch/ppc64/ppc64asm: skip TestObjdumpPowerManual if not ppc64x
    
    Skip TestObjdumpPowerManual if the host system is not ppc64 or ppc64le.
    This test depends on using the host objdump and comparing output, which
    does not work as expected if the test is run on another host.
    
    Orignates from golang.org/x/arch/ppc64/ppc64asm commit 8e2d4898.
    
    Fixes #17698
    
    Change-Id: I956b0fb78c5ec33641db752d46a755008403d269
    Reviewed-on: https://go-review.googlesource.com/32531
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit b82ae33b903e309140fd471eee2de4c8ac7c0b46
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Nov 1 09:39:01 2016 -0700

    cmd/compile: add debug print to identify unexpected objects
    
    This should never be called but should help identify causes of
    unexpected panics such as in issue #17716.
    
    Change-Id: Id6ad0cef1088a41bfcc69110a93484a7e39c4128
    Reviewed-on: https://go-review.googlesource.com/32480
    Run-TryBot: Robert Griesemer <gri@golang.org>
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 719b493312154b43e9ace5743f3d74efb155b9d7
Author: David Crawshaw <crawshaw@golang.org>
Date:   Mon Oct 31 08:59:05 2016 -0400

    plugin: do not leak cRelName on error path
    
    Fixes #17683
    
    Change-Id: I46f45c63796b58e8a8f14e37592231cbe7cd6934
    Reviewed-on: https://go-review.googlesource.com/32438
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 54ec7b072e017f7351f889f9f5b31bbf53a44119
Author: David Crawshaw <crawshaw@golang.org>
Date:   Sun Oct 30 20:30:38 2016 -0400

    runtime: access modules via a slice
    
    The introduction of -buildmode=plugin means modules can be added to a
    Go program while it is running. This means there exists some time
    while the program is running with the module is on the moduledata
    linked list, but it has not been initialized to the satisfaction of
    other parts of the runtime. Notably, the GC.
    
    This CL adds a new way of access modules, an activeModules function.
    It returns a slice of modules that is built in the background and
    atomically swapped in. The parts of the runtime that need to wait on
    module initialization can use this slice instead of the linked list.
    
    Fixes #17455
    
    Change-Id: I04790fd07e40c7295beb47cea202eb439206d33d
    Reviewed-on: https://go-review.googlesource.com/32357
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 807a7ebd5107b44ca93849f2b12b61bc4cacca10
Author: Michael Munday <munday@ca.ibm.com>
Date:   Fri Oct 7 12:16:26 2016 -0400

    cmd/compile: improve s390x rules for folding ADDconst into loads/stores
    
    There is no benefit to folding ADDconsts unless the resultant immediate
    will fit into a 20-bit signed integer, so limit these rules accordingly.
    
    Also the signed load operations were missing, so I've added them, and
    I've also removed some MOVDaddr rules that were dead code (MOVDaddrs
    are rematerializable on s390x which means they can't take inputs other
    than SP or SB).
    
    Change-Id: Iebeba78da37d3d71d32d4b7f49fe4ea9095d40ec
    Reviewed-on: https://go-review.googlesource.com/30616
    Run-TryBot: Michael Munday <munday@ca.ibm.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit d7b34d5f29324d77fad572676f0ea139556235e0
Author: Martin Möhrmann <martisch@uos.de>
Date:   Sun Oct 30 01:54:19 2016 +0200

    runtime: improve atoi implementation
    
    - Adds overflow checks
    - Adds parsing of negative integers
    - Adds boolean return value to signal parsing errors
    - Adds atoi32 for parsing of integers that fit in an int32
    - Adds tests
    
    Handling of errors to provide error messages
    at the call sites is left to future CLs.
    
    Updates #17718
    
    Change-Id: I3cacd0ab1230b9efc5404c68edae7304d39bcbc0
    Reviewed-on: https://go-review.googlesource.com/32390
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 40aaf283124de44d513ca086976194f0133faa82
Author: Carlos Eduardo Seo <cseo@linux.vnet.ibm.com>
Date:   Fri Oct 28 14:42:42 2016 -0200

    runtime: get ppc64x ISA level and hardware capabilities from HWCAP/HWCAP2
    
    This implements a check that can be done at runtime for the ISA level and
    hardware capability. It follows the same implementation as in s390x.
    
    These checks will be important as we enable new instructions and write go
    asm implementations using those.
    
    Updates #15403
    Fixes #16643
    
    Change-Id: Idfee374a3ffd7cf13a7d8cf0a6c83d247d3bee16
    Reviewed-on: https://go-review.googlesource.com/32330
    Reviewed-by: Lynn Boger <laboger@linux.vnet.ibm.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 47c58b46676af533a105fb10169522b958843a70
Author: Michael Munday <munday@ca.ibm.com>
Date:   Sat Oct 1 12:44:33 2016 -0400

    bytes, strings: optimize multi-byte index operations on s390x
    
    Use vector instructions to speed up indexing operations for short
    strings (64 bytes or less).
    
    bytes_s390x.go and strings_s390x.go are based on their amd64
    equivalents in CL 31690.
    
    bytes package:
    
    name                   old time/op    new time/op    delta
    Index/10                 40.3ns ± 7%    11.3ns ± 4%    -72.06%  (p=0.000 n=10+10)
    Index/32                  196ns ± 1%      27ns ± 2%    -86.25%  (p=0.000 n=10+10)
    Index/4K                 28.9µs ± 1%     1.5µs ± 2%    -94.94%    (p=0.000 n=9+9)
    Index/4M                 30.1ms ± 2%     1.5ms ± 3%    -94.94%  (p=0.000 n=10+10)
    Index/64M                 549ms ±13%      28ms ± 3%    -94.87%   (p=0.000 n=10+9)
    IndexEasy/10             18.8ns ±11%    11.5ns ± 2%    -38.81%  (p=0.000 n=10+10)
    IndexEasy/32             23.6ns ± 6%    28.1ns ± 3%    +19.29%  (p=0.000 n=10+10)
    IndexEasy/4K              251ns ± 5%     223ns ± 8%    -11.04%  (p=0.000 n=10+10)
    IndexEasy/4M              318µs ± 9%     266µs ± 8%    -16.42%  (p=0.000 n=10+10)
    IndexEasy/64M            14.7ms ±16%    13.2ms ±11%    -10.22%  (p=0.001 n=10+10)
    
    strings package:
    
    name                   old time/op  new time/op  delta
    IndexRune              88.1ns ±16%  28.9ns ± 4%  -67.20%  (p=0.000 n=10+10)
    IndexRuneLongString     456ns ± 7%    34ns ± 3%  -92.50%  (p=0.000 n=10+10)
    IndexRuneFastPath      12.9ns ±14%  11.1ns ± 6%  -13.84%  (p=0.000 n=10+10)
    Index                  13.0ns ± 7%  11.3ns ± 4%  -13.31%  (p=0.000 n=10+10)
    IndexHard1             3.38ms ± 9%  0.07ms ± 1%  -97.79%  (p=0.000 n=10+10)
    IndexHard2             3.58ms ± 7%  0.37ms ± 2%  -89.78%  (p=0.000 n=10+10)
    IndexHard3             3.47ms ± 7%  0.75ms ± 1%  -78.52%  (p=0.000 n=10+10)
    IndexHard4             3.56ms ± 6%  1.34ms ± 0%  -62.39%    (p=0.000 n=9+9)
    
    Change-Id: If36c2afb8c02e80fcaa1cf5ec2abb0a2be08c7d1
    Reviewed-on: https://go-review.googlesource.com/32447
    Run-TryBot: Michael Munday <munday@ca.ibm.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 11ff4b21f253f1c8a5a63608b0108a1438378c20
Author: Daniel Martí <mvdan@mvdan.cc>
Date:   Thu Oct 27 19:47:47 2016 +0100

    testing: don't warn if -bench was passed
    
    In a previous change, cmd/go was taught to show a "no tests ran" warning
    if test did nothing. But it missed a case - if no tests nor examples ran
    but any benchmarks were meant to be run, it would still produce the
    warning. This meant that running only benchmarks, which is common, would
    be confusing:
    
             $ go test -run='^$' -bench=.
            testing: warning: no tests to run
            BenchmarkFoo-4            300000              5056 ns/op
            [...]
    
    I believe this was because of a copy-paste error in the tests. This was
    being tested, but on the wrong file which does contain a test that was
    being run. Fix the path and fix the now failing test by never showing
    the warning if -bench was given a non-empty string.
    
    The rationale is that if -bench was given but there was no output, it's
    obvious that nothing happened as benchmarks always produce output even
    without -v. So showing a warning in those cases is redundant.
    
    To make future typos less likely, make sure that no tests are being run
    in the cases where we only want to run benchmarks.
    
    Fixes #17603.
    
    Change-Id: I4c626caf39f72260c6a9761c06446663f465f947
    Reviewed-on: https://go-review.googlesource.com/32157
    Reviewed-by: Marcel van Lohuizen <mpvl@golang.org>
    Run-TryBot: Marcel van Lohuizen <mpvl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 4a13f31ffd4ff8648ccc4c2b2193abde22f7fd26
Author: Emmanuel Odeke <emm.odeke@gmail.com>
Date:   Fri Oct 28 08:11:39 2016 -0700

    net/http/httputil: add ModifyResponse to reverseProxy
    
    Adds ModifyResponse, an optional func to ReverseProxy
    that modifies a response in the backend, right before
    the headers of the response are written to the internal
    response writer.
    If ModifyResponse returns an error, the proxy returns
    a StatusBadGateway error.
    
    Fixes #14237.
    
    Change-Id: I8e03139e34dea0084512ccbd8cc49e941bf9fb5d
    Reviewed-on: https://go-review.googlesource.com/32356
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 032d150bd4a812eee9c3ea017f0d3acc8c484325
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Mon Oct 31 17:34:42 2016 -0700

    encoding/json: marshal with null when RawMessage is nil
    
    This CL expands upon a change made in (http://golang.org/cl/21811)
    to ensure that a nil RawMessage gets serialized as "null" instead of
    being a nil slice.
    
    The added check only triggers when the RawMessage is nil. We do not
    handle the case when the RawMessage is non-nil, but empty.
    
    Fixes #17704
    Updates #14493
    
    Change-Id: I0fbebcdd81f7466c5b78c94953afc897f162ceb4
    Reviewed-on: https://go-review.googlesource.com/32472
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 7a26d9fcedd94a1ba0d95833b0cdbbdcc776fe19
Author: Robert Griesemer <gri@golang.org>
Date:   Mon Oct 31 16:58:15 2016 -0700

    cmd/compile/internal/syntax: don't panic if no error handler is provided
    
    If no error handler is provided, terminate parsing with first error
    and report that error.
    
    Fixes #17697.
    
    Change-Id: I9070faf7239bd53725de141507912b92ded3474b
    Reviewed-on: https://go-review.googlesource.com/32456
    Run-TryBot: Robert Griesemer <gri@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 53fc330e2d154443acf3d01e0d68bae22b2b7804
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Sun Oct 30 03:28:05 2016 +0000

    net/http: add Server.Close & Server.Shutdown for forced & graceful shutdown
    
    Also updates x/net/http2 to git rev 541150 for:
    
       http2: add support for graceful shutdown of Server
       https://golang.org/cl/32412
    
       http2: make http2.Server access http1's Server via an interface check
       https://golang.org/cl/32417
    
    Fixes #4674
    Fixes #9478
    
    Change-Id: I8021a18dee0ef2fe3946ac1776d2b10d3d429052
    Reviewed-on: https://go-review.googlesource.com/32329
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 2d4d22af7e8482054a6f802ec798f4af4d37596f
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Mon Oct 31 16:42:30 2016 -0700

    cmd/compile: move parser.go remnants into noder.go
    
    Change-Id: I54f8788a4703283b9aa3904e2e610097ac3e3586
    Reviewed-on: https://go-review.googlesource.com/32471
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: Robert Griesemer <gri@golang.org>

commit f2d05389da562fd58143995195b5f6f844eb89e1
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 31 17:37:05 2016 -0400

    runtime: perform write barriers on direct channel receive
    
    Currently we have write barriers for direct channel sends, where the
    receiver is blocked and the sender is writing directly to the
    receiver's stack; but not for direct channel receives, where the
    sender is blocked and the receiver is reading directly from the
    sender's stack.
    
    This was okay with the old write barrier because either 1) the
    receiver would write the received pointer into the heap (causing it to
    be shaded), 2) the pointer would still be on the receiver's stack at
    mark termination and we would rescan it, or 3) the receiver dropped
    the pointer so it wasn't necessarily reachable anyway.
    
    This is not okay with the write barrier because it lets a grey stack
    send a white pointer to a black stack and then remove it from its own
    stack. If the grey stack was the sole grey-protector of this pointer,
    this hides the object from the garbage collector.
    
    Fix this by making direct receives perform a stack-to-stack write
    barrier just like direct sends do.
    
    Fixes #17694.
    
    Change-Id: I1a4cb904e4138d2ac22f96a3e986635534a5ae41
    Reviewed-on: https://go-review.googlesource.com/32450
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 9a8bf2d67de6884d99760a065d7af508b85e38d7
Author: Dhananjay Nakrani <dhananjaynakrani@gmail.com>
Date:   Sat Oct 29 12:10:21 2016 -0700

    cmd/compile: avoid nil-ing out a node's Type in typecheckcomplit() on error
    
    typecheckcomplit nils out node's type, upon finding new errors.
    This hides new errors in children's node as well as the type info
    of current node. This change fixes that.
    
    Fixes #17645.
    
    Change-Id: Ib473291f31c7e8fa0307cb1d494e0c112ddd3583
    Reviewed-on: https://go-review.googlesource.com/32324
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit d35dfd405eaa21654807fac3891e198538d3c402
Author: Austin Clements <austin@google.com>
Date:   Sun Oct 30 17:59:06 2016 -0400

    runtime: make assists perform root jobs
    
    Currently, assists can only perform heap marking jobs. However, at the
    beginning of GC, there are only root jobs and no heap marking jobs. As
    a result, there's often a period at the beginning of a GC cycle where
    no goroutine has accumulated assist credit, but at the same time it
    can't get any credit because there are no heap marking jobs for it to
    do yet. As a result, many goroutines often block on the assist queue
    at the very beginning of the GC cycle.
    
    This commit fixes this by allowing assists to perform root marking
    jobs. The tricky part of this (and the reason we haven't done this
    before) is that stack scanning jobs can lead to deadlocks if the
    goroutines performing the stack scanning are themselves
    non-preemptible, since two non-preemptible goroutines may try to scan
    each other. To address this, we use the same insight d6625ca used to
    simplify the mark worker stack scanning: as long as we're careful with
    the stacks and only drain jobs while on the system stack, we can put
    the goroutine into a preemptible state while we drain jobs. This means
    an assist's user stack can be scanned while it continues to do work.
    
    This reduces the rate of assist blocking in the x/benchmarks HTTP
    benchmark by a factor of 3 and all remaining blocking happens towards
    the *end* of the GC cycle, when there may genuinely not be enough work
    to go around.
    
    Ideally, assists would get credit for working on root jobs. Currently
    they do not; however, this change prioritizes heap work over root jobs
    in assists, so they're likely to mostly perform heap work. In contrast
    with mark workers, for assists, the root jobs act only as a backstop
    to create heap work when there isn't enough heap work.
    
    Fixes #15361.
    
    Change-Id: If6e169863e4ad75710b0c8dc00f6125b41e9a595
    Reviewed-on: https://go-review.googlesource.com/32432
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit f9e1adb713e35233ff65f3bde7715377964fafbd
Author: Austin Clements <austin@google.com>
Date:   Sun Oct 30 17:46:49 2016 -0400

    runtime: lift systemstack part of gcAssistAlloc
    
    This lifts the part of gcAssistAlloc that runs on the system stack to
    its own function in preparation for letting assists perform root jobs
    (notably stack scanning). This makes it easy to see that there are no
    references to the user stack once we've entered gcAssistAlloc1, which
    means it's safe to shrink the stack while in gcAssistAlloc1.
    
    This does not yet make assists perform root jobs, so it's not actually
    possible for the stack to shrink yet. That will happen in the next
    commit.
    
    The code in gcAssistAlloc1 is identical to the code that's currently
    passed in a closure to systemstack with one exception. Currently, we
    set the "completed" variable in the enclosing scope to indicate that
    the assist completed the mark phase. This is exactly the sort of
    cross-stack reference lifting this function is meant to prevent. We
    replace this variable with setting gp.param to nil or non-nil to
    indicate the completion status.
    
    Updates #15361.
    
    Change-Id: Iba7cfb758c781070a441aea86c0117b399a24dbd
    Reviewed-on: https://go-review.googlesource.com/32431
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Run-TryBot: Austin Clements <austin@google.com>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit cba0957a91b7f3ce16c06046b5c971e46ff806ef
Author: Robert Griesemer <gri@golang.org>
Date:   Mon Oct 31 14:38:12 2016 -0700

    go/types: basic Defs/Uses test for aliases
    
    Change-Id: I113ea712838511ee823375d9ea059089195414f5
    Reviewed-on: https://go-review.googlesource.com/32449
    Run-TryBot: Robert Griesemer <gri@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 9dba33872a6a762e27b42a01ec50ac815916aec4
Author: Jaana Burcu Dogan <jbd@google.com>
Date:   Mon Oct 31 11:38:22 2016 -0700

    doc: replace code.google.com/p/sitesearch with its new destination
    
    Fixes #16910.
    
    Change-Id: I0e97e88bee0361cd3621cacd1d4b84e6e42af718
    Reviewed-on: https://go-review.googlesource.com/32424
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit a42ba23da231e6e163aa2e1537a52a1880f21ad8
Author: Robert Griesemer <gri@golang.org>
Date:   Mon Oct 31 12:52:43 2016 -0700

    go/types: implement missing String method for Alias object
    
    Change-Id: Iba5cfa033483b843dbd3681ffad50b117cced4a7
    Reviewed-on: https://go-review.googlesource.com/32448
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit f46239b85c97ef32ef4f5c9476d77c812125b441
Author: Dhananjay Nakrani <dhananjaynakrani@gmail.com>
Date:   Sun Oct 30 12:47:53 2016 -0700

    cmd/compile: initialize Decldepth in all cases
    
    Previously, on encountering Func.Nname.Type == nil, typecheckfunc()
    returned without initializing Decldepth for that func. This causes
    typecheckclosure() to fatal. This change ensures that we initialize
    Decldepth in all cases.
    
    Fixes #17588.
    
    Change-Id: I2e3c81ad52e8383395025388989e8dbf03438b68
    Reviewed-on: https://go-review.googlesource.com/32415
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 741445068f7f582824f1c5625159e0b728090265
Author: Keith Randall <khr@golang.org>
Date:   Sun Oct 30 21:10:03 2016 -0700

    cmd/compile: make [0]T and [1]T SSAable types
    
    We used to have to keep on-stack copies of these types.
    Now they can be registerized.
    
    [0]T is kind of trivial but might as well handle it.
    
    This change enables another change I'm working on to improve how x.(T)
    expressions are handled (#17405).  This CL helps because now all
    types that are direct interface types are registerizeable (e.g. [1]*byte).
    
    No higher-degree arrays for now because non-constant indexes are hard.
    
    Update #17405
    
    Change-Id: I2399940965d17b3969ae66f6fe447a8cefdd6edd
    Reviewed-on: https://go-review.googlesource.com/32416
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit 9c066bab643a0224decdd71813096e0d1df0624c
Author: David Chase <drchase@google.com>
Date:   Fri Oct 28 13:33:57 2016 -0400

    cmd/compile: mark temps with new AutoTemp flag, and use it.
    
    This is an extension of
    https://go-review.googlesource.com/c/31662/
    to mark all the temporaries, not just the ssa-generated ones.
    
    Before-and-after ls -l `go tool -n compile` shows a 3%
    reduction in size (or rather, a prior 3% inflation for
    failing to filter temps out properly.)
    
    Replaced name-dependent "is it a temp?" tests with calls to
    *Node.IsAutoTmp(), which depends on AutoTemp.  Also replace
    calls to istemp(n) with n.IsAutoTmp(), to reduce duplication
    and clean up function name space.  Generated temporaries
    now come with a "." prefix to avoid (apparently harmless)
    clashes with legal Go variable names.
    
    Fixes #17644.
    Fixes #17240.
    
    Change-Id: If1417f29c79a7275d7303ddf859b51472890fd43
    Reviewed-on: https://go-review.googlesource.com/32255
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit eec1e5d9c6d00fc493714a09b71e2bca2d7e7fa4
Author: Robert Griesemer <gri@golang.org>
Date:   Mon Oct 31 11:16:15 2016 -0700

    go/types: don't expose types.Alias kind field - only used by go/types
    
    Change-Id: I8a28a88a655d9929f8641f71573dc01dc53be00f
    Reviewed-on: https://go-review.googlesource.com/32443
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 3f6070cc915b8175f4b7d1324a8320b881e891a2
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Mon Oct 31 11:43:40 2016 -0700

    vendor/golang_org/text/unicode/norm: re-vendor
    
    This picks up just a trivial fix,
    making vet (and thus me) happy.
    
    Change-Id: Ib82ae44c081ff1ec5c078196a6cd5e1a3505d03b
    Reviewed-on: https://go-review.googlesource.com/32427
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 35d342eb7d2e0c661b3bc5abd5f82d1d0717fb56
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Mon Oct 31 11:41:34 2016 -0700

    cmd/vet/all: update whitelists
    
    Change-Id: Ic66eb2939d83559610e62cbb181a8faa6193ecc4
    Reviewed-on: https://go-review.googlesource.com/32426
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 4de3df8c954e2b3368550b652c5ee861df6717d0
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Mon Oct 31 11:41:24 2016 -0700

    cmd/compile: remove unreachable code
    
    Makes vet happy.
    
    Change-Id: I00de44a844afa57901b31991acf9e7ac834a9572
    Reviewed-on: https://go-review.googlesource.com/32425
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit b5203be87dc8edae182a8b45901ba8306e37110e
Author: Robert Griesemer <gri@golang.org>
Date:   Fri Oct 28 16:17:43 2016 -0700

    go/importer: implement importing of exported aliases
    
    Fixes #17592.
    
    Change-Id: I914fa8c0729012990878b6e5c3e99b0f9b0e2be8
    Reviewed-on: https://go-review.googlesource.com/32350
    Run-TryBot: Robert Griesemer <gri@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 49b2dd583beffaf983910f24c5e2d02a31d0c5b4
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Mon Oct 31 12:01:32 2016 -0700

    cmd/compile: remove legacy debug flags
    
    -M, -P, and -R were for debugging backend passes that no longer
    exists.
    
    -g is used for debugging instructions generated with Gins, but the SSA
    backend mostly generates instructions directly. The handful of
    instructions still generated with Gins are pretty useless for
    debugging.
    
    -x was used to debug the old lexer, but now it only causes us to print
    file names as they're parsed, and only if we manually hack the
    compiler to enable tracing.
    
    Change-Id: Ia58d4bc9c1312693466171a3fcefc1221e9a2381
    Reviewed-on: https://go-review.googlesource.com/32428
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 7b50bd8abfe8565abdf7a6116e22a6a0fbf582b7
Author: Mike Strosaker <strosake@us.ibm.com>
Date:   Fri Oct 28 19:50:16 2016 -0400

    crypto/sha256: improve performance for sha256.block on ppc64le
    
    Adds an assembly implementation of sha256.block for ppc64le to improve its
    performance.  This implementation is largely based on the original amd64
    implementation, which unrolls the 64 iterations of the inner loop.
    
    Fixes #17652
    
    benchmark               old ns/op     new ns/op     delta
    BenchmarkHash8Bytes     1263          767           -39.27%
    BenchmarkHash1K         14048         7766          -44.72%
    BenchmarkHash8K         102245        55626         -45.60%
    
    benchmark               old MB/s     new MB/s     speedup
    BenchmarkHash8Bytes     6.33         10.43        1.65x
    BenchmarkHash1K         72.89        131.85       1.81x
    BenchmarkHash8K         80.12        147.27       1.84x
    
    Change-Id: Ib4adf429423b20495580400be10bd7e171bcc70b
    Reviewed-on: https://go-review.googlesource.com/32318
    Reviewed-by: Carlos Eduardo Seo <cseo@linux.vnet.ibm.com>
    Reviewed-by: David Chase <drchase@google.com>
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 854ae03db4c6c398149dc1e46fbec49479d8cb1f
Author: Mike Strosaker <strosake@us.ibm.com>
Date:   Sat Oct 29 02:36:41 2016 -0400

    crypto/sha512: improve performance for sha512.block on ppc64le
    
    Adds an assembly implementation of sha512.block for ppc64le to improve its
    performance.  This implementation is largely based on the original amd64
    implementation, unrolling the 80 iterations of the inner loop.
    
    Fixes #17660
    
    benchmark               old ns/op     new ns/op     delta
    BenchmarkHash8Bytes     1715          1133          -33.94%
    BenchmarkHash1K         10098         5513          -45.41%
    BenchmarkHash8K         68004         35278         -48.12%
    
    benchmark               old MB/s     new MB/s     speedup
    BenchmarkHash8Bytes     4.66         7.06         1.52x
    BenchmarkHash1K         101.40       185.72       1.83x
    BenchmarkHash8K         120.46       232.21       1.93x
    
    Change-Id: Ifd55a49a24cb159b3a09a8e928c3f37727aca103
    Reviewed-on: https://go-review.googlesource.com/32320
    Reviewed-by: Carlos Eduardo Seo <cseo@linux.vnet.ibm.com>
    Reviewed-by: David Chase <drchase@google.com>
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 051cf380f5723fcb062728b7abfda40727b48746
Author: Michael Matloob <matloob@golang.org>
Date:   Mon Oct 31 15:30:59 2016 +0000

    go/build: add back deps for runtime/pprof/internal/gzip0
    
    These were accidentally removed by a rollback cl: golang.org/cl/32441
    
    Change-Id: I0cfa8b3397be324dabfb8f33b6548a03c10571eb
    Reviewed-on: https://go-review.googlesource.com/32334
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 9e227acfb62b091eea743bef03bbe466e4070df9
Author: Michael Matloob <matloob@golang.org>
Date:   Mon Oct 31 15:30:59 2016 +0000

    Revert "runtime/pprof: write profiles in protobuf format."
    
    This reverts commit b33030a72754cb55d6ec137e79facacb398c9be4.
    
    Reason for revert: We're going to try to get the code in this change
    submitted in smaller, more carefully reviewed changes.
    
    Change-Id: I4175f4b297f0e69fb78b11f9dc0bd82f27865be7
    Reviewed-on: https://go-review.googlesource.com/32441
    Reviewed-by: Russ Cox <rsc@golang.org>

commit 61ffec4b52f64793ad450d1a2d8c4144fa3d5f18
Author: Quentin Renard <contact@asticode.com>
Date:   Sat Oct 8 15:52:25 2016 +0200

    net/http: returned typed error on Transport proxy dial
    
    Fixes #16997
    
    Change-Id: I9ca27d8cff1905584862997d0e8a11ce3c4c21cb
    Reviewed-on: https://go-review.googlesource.com/30750
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 92568bcb6a374aecf2ece6607829b26f5e57ac28
Author: Kevin Burke <kev@inburke.com>
Date:   Mon Oct 31 07:32:19 2016 -0700

    database/sql: correctly spell constants
    
    Also add a link to more information about isolation levels as defined by the
    SQL standard. Fixes #17682.
    
    Change-Id: I94c53b713f4c882af40cf15fe5f1e5dbc53ea741
    Reviewed-on: https://go-review.googlesource.com/32418
    Reviewed-by: Daniel Theophanes <kardianos@gmail.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 4b90b7a28a0c1a849eed765cc511eacbae4d2651
Author: INADA Naoki <songofacandy@gmail.com>
Date:   Wed Oct 26 17:11:13 2016 +0900

    database/sql: add Pinger interface to driver Conn
    
    Change-Id: If6eb3a7c9ad48a517e584567b1003479c1df6cca
    Reviewed-on: https://go-review.googlesource.com/32136
    Reviewed-by: Daniel Theophanes <kardianos@gmail.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 398e861d9787d7da62a385110539d74dec34c18c
Author: Jaana Burcu Dogan <jbd@google.com>
Date:   Mon Oct 31 08:58:42 2016 -0700

    reflect: clarify that NumMethod returns only the number of exported methods
    
    Fixes #17686.
    
    Change-Id: I7d07c367e50b448579f9855bea43df76ddb82bd0
    Reviewed-on: https://go-review.googlesource.com/32420
    Reviewed-by: Rob Pike <r@golang.org>

commit 53c004f94efa85f05b28938509b250e02d1568ea
Author: Robert Griesemer <gri@golang.org>
Date:   Thu Oct 27 17:40:33 2016 -0700

    go/types: local type-checking of alias declarations
    
    Does not handle imports of packages with exported aliases yet.
    
    For #17592.
    
    Change-Id: Iee63fb9d521014995003a417271fbe0384ae04ef
    Reviewed-on: https://go-review.googlesource.com/32108
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit f4c7a12c2c4b0aef99b4957a778736a4da9ae4ec
Author: David Crawshaw <crawshaw@golang.org>
Date:   Sun Oct 30 21:19:59 2016 -0400

    runtime: make module typemaps visible to the GC
    
    The map[typeOff]*_type object is created at run time and stored in
    the moduledata. The moduledata object is marked by the linker as
    SNOPTRDATA, so the reference is ignored by the GC. Running
    misc/cgo/testplugin/test.bash with GOGC=1 will eventually collect
    the typemap and crash.
    
    This bug probably comes up in -linkshared binaries in Go 1.7.
    I don't know why we haven't seen a report about this yet.
    
    Fixes #17680
    
    Change-Id: I0e9b5c006010e8edd51d9471651620ba665248d3
    Reviewed-on: https://go-review.googlesource.com/32430
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Michael Hudson-Doyle <michael.hudson@canonical.com>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 9da7058466c8c9f32e1481f28d57732832ee3b30
Author: David Crawshaw <crawshaw@golang.org>
Date:   Sun Oct 30 15:31:21 2016 -0400

    cmd/link, plugin: use full plugin path for symbols
    
    Plumb the import path of a plugin package through to the linker, and
    use it as the prefix on the exported symbol names.
    
    Before this we used the basename of the plugin file as the prefix,
    which could conflict and result in multiple loaded plugins sharing
    symbols that are distinct.
    
    Fixes #17155
    Fixes #17579
    
    Change-Id: I7ce966ca82d04e8507c0bcb8ea4ad946809b1ef5
    Reviewed-on: https://go-review.googlesource.com/32355
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 590fce48849cc7f81b890d6e9b6120fc6681e19a
Author: Nigel Tao <nigeltao@golang.org>
Date:   Sat Oct 29 13:23:50 2016 +1100

    compress/flate: tighten the BestSpeed max match offset bound.
    
    Previously, we were off by one.
    
    Also fix a comment typo.
    
    Change-Id: Ib94d23acc56d5fccd44144f71655481f98803ac8
    Reviewed-on: https://go-review.googlesource.com/32149
    Reviewed-by: Joe Tsai <thebrokentoaster@gmail.com>
    Run-TryBot: Joe Tsai <thebrokentoaster@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit f135106ec7cf68b47a5b83a1c2b5dd7eda0d614c
Author: Ian Lance Taylor <iant@golang.org>
Date:   Sun Oct 30 12:30:47 2016 -0400

    cmd/cgo: add -srcdir option
    
    This is convenient for direct use of `go tool cgo`. We can also use it
    from the go tool to reduce the length of the file names that cgo
    generates.
    
    Update #17070.
    
    Change-Id: I8466a0a2cc68a732d17d07319e303497715bac8c
    Reviewed-on: https://go-review.googlesource.com/32354
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

commit ba048f7ce4a14e956635efc80fc1447c3b8851dd
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 20 20:26:31 2016 -0400

    sync: enable Pool when using race detector
    
    Disabled by https://golang.org/cl/53020044 due to false positives.
    Reenable and model properly.
    
    Fixes #17306.
    
    Change-Id: I28405ddfcd17f58cf1427c300273212729154359
    Reviewed-on: https://go-review.googlesource.com/31589
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

commit 154860ff17dacbf309ed247277d245ec887af6d4
Author: Ian Gudger <igudger@google.com>
Date:   Fri Oct 28 20:09:02 2016 -0700

    syscall: remove X__cmsg_data from Cmsghdr
    
    This field is a zero length array and has little use. Since Go 1.5, trailing
    zero-length arrays take up space. Both syscall.UnixRights() and
    syscall.ParseSocketControlMessage() depend on being able to do an unsafe cast
    of socket control message data to Cmsghdr this is only safe if the socket
    control message data is greater than or equal to the size of Cmsghdr. Since
    control message data that is equal in size to Cmsghdr without X__cmsg_data is
    a valid socket control message, we must remove X__cmsg_data or not perform the
    unsafe cast.
    
    Removing X__cmsg_data will prevent Go code that uses X__cmsg_data from
    compiling, but removing the unsafe cast will cause Go code that uses
    X__cmsg_data to fail or exhibit undefined behavior at runtime. It was
    therefore decided that removing X__cmsg_data was the better option.
    
    Fixes #17649
    
    Change-Id: I39f323f978eca09d62da5785c5c5c9c7cbdf8c31
    Reviewed-on: https://go-review.googlesource.com/32319
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit ce6aa2ebdab0c6616ef17acc9282b0e168f5f21a
Author: Daniel Theophanes <kardianos@gmail.com>
Date:   Sun Oct 16 23:11:55 2016 -0700

    database/sql: add context helper methods and transaction types
    
    Prior to this change, it was implied that transaction properties
    would be carried in the context value. However, no such properties
    were defined, not even common ones. Define two common properties:
    isolation level and read-only. Drivers may choose to support
    additional transaction properties. It is not expected any
    further transaction properties will be added in the future.
    
    Change-Id: I2f680115a14a1333c65ba6f943d9a1149d412918
    Reviewed-on: https://go-review.googlesource.com/31258
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 042264ef1b073b1b485e6e24977e506e1a6bdb3f
Author: Dmitry Vyukov <dvyukov@google.com>
Date:   Fri Oct 28 17:12:39 2016 +0200

    runtime/race: update race runtime
    
    This updates the runtime to HEAD to keep it aligned and fixes some bugs.
    
    http://llvm.org/viewvc/llvm-project?view=revision&revision=285454
    fixes the crash on darwin related to unaligned data section (#17065).
    
    http://llvm.org/viewvc/llvm-project?view=revision&revision=285451
    enables core dumps by default (#16527).
    
    http://llvm.org/viewvc/llvm-project?view=revision&revision=285455
    adds a hook to obtain number of races reported so far (#15972).
    Can now be obtained with:
    
    //go:nosplit
    func RaceReportCount() int {
            var n uint64
            racecall(&__tsan_report_count, uintptr(unsafe.Pointer(&n)), 0, 0, 0)
            return int(n)
    }
    
    Fixes #16527.
    Fixes #17065.
    Update #15972.
    
    Change-Id: I8f869cb6275c9521a47303f3810a9965e9314357
    Reviewed-on: https://go-review.googlesource.com/32160
    Run-TryBot: Dmitry Vyukov <dvyukov@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 7ba36f4adb43355ef4b870d64d23f9988b1279ea
Author: Keith Randall <khr@golang.org>
Date:   Wed Oct 26 21:25:56 2016 -0700

    runtime: compute size classes statically
    
    No point in computing this info on startup.
    Compute it at build time.
    This lets us spend more time computing & checking the size classes.
    
    Improve the div magic for rounding to the start of an object.
    We can now use 32-bit multiplies & shifts, which should help
    32-bit platforms.
    
    The static data is <1KB.
    
    The actual size classes are not changed by this CL.
    
    Change-Id: I6450cec7d1b2b4ad31fd3f945f504ed2ec6570e7
    Reviewed-on: https://go-review.googlesource.com/32219
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Austin Clements <austin@google.com>

commit 753caecc7e576e46a329b71c49dbf0ea9bfbd867
Author: Ian Lance Taylor <iant@golang.org>
Date:   Sat Oct 29 22:32:59 2016 -0400

    cmd/go: set CCACHE_DIR when setting HOME to non-existent dir
    
    This fixes systems for which ccache is the default compiler.
    
    Also remove a couple of temporary files created by TestImportMain.
    
    Fixes #17668.
    
    Change-Id: I1edefdcec5f417be0533c146253c35ff4928c1c0
    Reviewed-on: https://go-review.googlesource.com/32328
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 7db996ee77b20b68ee583c65d59be1d81cef9090
Author: Emmanuel Odeke <emm.odeke@gmail.com>
Date:   Mon Sep 26 20:38:57 2016 -0700

    net/http: handle 3xx redirects properly
    
    Provides redirection support for 307, 308 server statuses.
    Provides redirection support for DELETE method.
    
    Updates old tests that assumed all redirects were treated
    the way 301, 302 and 303 are processed.
    
    Fixes #9348
    Fixes #10767
    Fixes #13994
    
    Change-Id: Iffa8dbe0ff28a1afa8da59869290ec805b1dd2c4
    Reviewed-on: https://go-review.googlesource.com/29852
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit f030eb634f6c0e8de9cebd7fa7c2ac7890cabcc7
Author: Mikio Hara <mikioh.mikioh@gmail.com>
Date:   Sun Oct 30 09:46:36 2016 +0900

    net: fix nit
    
    Change-Id: Iec469846dc8b5a747ad81690000f1f6f53721ea1
    Reviewed-on: https://go-review.googlesource.com/32372
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit b4e714e59efd21f9140a3e8e2b0182c74bfde437
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Sat Oct 29 12:25:20 2016 -0700

    compress/gzip: only encode MTIME if it is valid
    
    The GZIP format records the ModTime as an uint32 counting seconds since
    the Unix epoch. The zero value is explicitly defined in section 2.3.1
    as meaning no timestamp is available.
    
    Currently, the Writer always encodes the ModTime even if it is the zero
    time.Time value, which causes the Writer to try and encode the value
    -62135596800 into the uint32 MTIME field. This causes an overflow and
    results in our GZIP files having MTIME fields indicating a date in 2042-07-13.
    
    We alter the Writer to only encode ModTime if the value does not underflow
    the MTIME field (i.e., it is newer than the Unix epoch). We do not attempt
    to fix what happens when the timestamp overflows in the year 2106.
    
    We alter the Reader to only decode ModTime if the value is non-zero.
    There is no risk of overflowing time.Time when decoding.
    
    Fixes #17663
    
    Change-Id: Ie1b65770c6342cd7b14aeebe10e5a49e6c9eb730
    Reviewed-on: https://go-review.googlesource.com/32325
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 4b130f92d248cfa37dceeb45622d36d9c90331ff
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Sat Oct 29 18:44:07 2016 +0000

    net/http: update bundled http2 for IdleTimeout config sync change
    
    Updates http2 to x/net git rev 76c1a11e for:
    
         http2: initialize Server.IdleTimeout from http.Server as http1 does
         https://golang.org/cl/32230
    
         http2: change how Server.IdleTimeout is initialized from http.Server
         https://golang.org/cl/32323
    
    Fixes #14204
    
    Change-Id: I099f89fcd0d8bc0e42da163ae0a3b786fd81292f
    Reviewed-on: https://go-review.googlesource.com/32322
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 5552d08b14b6a5099147934111a34f8362341ae2
Author: Russ Cox <rsc@golang.org>
Date:   Sat Oct 29 13:53:22 2016 -0400

    cmd/go: test fixes dropped from CL 31821
    
    Because git.
    
    Change-Id: Ia1e7c6ba0e8c4d47f993487d2483cbb213b465e5
    Reviewed-on: https://go-review.googlesource.com/32351
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 1773cdd0811620fd59b44136a77ecef4d728ae18
Author: Russ Cox <rsc@golang.org>
Date:   Tue Oct 25 08:59:35 2016 -0400

    cmd/link: fix -X importpath.name=value when import path needs escaping
    
    After the final slash, dots are %-escaped when constructing a symbol name,
    so that in the actual symbol table, the import path githost.com/my.git
    becomes githost.com/my%2egit. In this case, -X githost.com/my.git.Value=foo
    needs to set githost.com/my%2egit.Value. This is a detail of the object format
    and not something users should know or depend on, so apply the escaping
    as needed.
    
    People who have run across this already and figured out and started using
    the escaped forms with -X will find those forms not working anymore.
    That is, -X githost.com/my%2egit.Value=foo is the Go 1.7 workaround but
    will stop working in Go 1.8 once this proper fix is in place.
    People who need to keep scripts working with older and newer versions of Go
    can safely pass both forms, and one will be ignored:
    
        -X githost.com/my%2egit.Value=foo -X githost.com/my.git.Value=foo
    
    Fixes #16710.
    
    Change-Id: I0e994ccdd412a4eb8349fefce9aeb3bfc9a83cd8
    Reviewed-on: https://go-review.googlesource.com/31970
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 03d641b990bf83b0553d723a2b8764af48de4e11
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 20 17:14:47 2016 -0400

    net: break up >1GB reads and writes on stream connections
    
    Also fix behavior of Buffers.WriteTo when writev returns an error.
    
    Fixes #16266.
    
    Change-Id: Idc9503408ce2cb460663768fab86035cbab11aef
    Reviewed-on: https://go-review.googlesource.com/31584
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 21a1fe4ddf77a49fee1d82d1891e66b1dce932bb
Author: Russ Cox <rsc@golang.org>
Date:   Fri Oct 28 17:02:29 2016 -0400

    runtime/pprof/internal/gzip0: new package for pprof
    
    Writes gzip-format uncompressed files.
    
    Change-Id: Id5dc01852e21732978700fd9efcc2d4a5899ffeb
    Reviewed-on: https://go-review.googlesource.com/32260
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Joe Tsai <thebrokentoaster@gmail.com>
    Reviewed-by: Michael Matloob <matloob@golang.org>

commit 8f91865e1b2f2df95fb4833babbd0a8fb26085c8
Author: Zev Goldstein <zev.goldstein@gmail.com>
Date:   Fri Oct 28 11:42:27 2016 -0400

    path/filepath: fix Abs on Windows
    
    The filepath.Abs function in windows did not call Clean as the
    documentation claimed.  This change not only fixes that behavior but
    also adjusts TestAbs to verify Abs calls Clean as documented.
    
    Fixes #17210
    
    Change-Id: I20c5f5026042fd7bd9d929ff5b17c8b2653f8afe
    Reviewed-on: https://go-review.googlesource.com/32292
    Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Alex Brainman <alex.brainman@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 833f57ed502d686ce054ff557cf3bf5b6ed1a1d2
Author: Alberto Donizetti <alb.donizetti@gmail.com>
Date:   Thu Oct 27 11:44:51 2016 +0200

    cmd/compile: make Node.Diag a bool
    
    Change-Id: I017c2ef7cc6248d3f4e38a791cd2576e941984ed
    Reviewed-on: https://go-review.googlesource.com/32156
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 7b4545653c371be73c660bc87356ec467496dbbf
Author: Emmanuel Odeke <emm.odeke@gmail.com>
Date:   Thu Oct 27 21:52:33 2016 -0700

    cmd/compile: improve error message for unknown fields in structs
    
    Improves the error message by moving the field name before the body
    of a struct, in the error message for unknown fields for structs.
    
    * Exhibit:
    Given program:
    
    package main
    
    import "time"
    
    func main() {
      _ = struct {
        about      string
        before     map[string]uint
        update     map[string]int
        updateTime time.Time
        expect     map[string]int
      }{
        about:   "this one",
        updates: map[string]int{"gopher": 10},
      }
    }
    
    * Before:
    ./issue17631.go:20: unknown struct { about string; before map[string]uint;
     update map[string]int; updateTime time.Time; expect map[string]int } field
    'updates' in struct literal
    
    * After:
    ./issue17631.go:20: unknown field 'updates' in struct literal of type { about string;
    before map[string]uint; update map[string]int; updateTime time.Time;
    expect map[string]int }
    
    Fixes #17631
    
    Change-Id: I76842616411b931b5ad7a76bd42860dfde7739f4
    Reviewed-on: https://go-review.googlesource.com/32240
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>

commit 894abb5f680c040777f17f9f8ee5a5ab3a03cb94
Author: Dmitry Vyukov <dvyukov@google.com>
Date:   Sat Oct 29 00:53:49 2016 +0200

    runtime/race: ignore user GORACE env var in tests
    
    I did 'export GORACE=atexit_sleep_ms=0' in a console
    and then was puzzled as to why race tests fail.
    Existing GORACE env var may (or may not) override
    the one that we setup.
    Filter out GORACE as we do for other important env vars.
    
    Change-Id: I29be86b0cbb9b5dc7f9efb15729ade86fc79b0e0
    Reviewed-on: https://go-review.googlesource.com/32163
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit cf28726c8d692bf74af1bd2366a6320f964a025f
Author: Than McIntosh <thanm@google.com>
Date:   Fri Oct 28 13:28:56 2016 -0400

    test: add test for gccgo issue #17640
    
    Change-Id: Iec35f9b62982da40de400397bc456149216303dc
    Reviewed-on: https://go-review.googlesource.com/32297
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit ee457118cd7b11264719647fa6f7422bac2a4431
Author: Martin Möhrmann <martisch@uos.de>
Date:   Wed Oct 26 00:01:58 2016 +0200

    cmd/compile: cleanup checkmake
    
    Change-Id: Icea4661db4a254e64b2129f429e5ef21ec1612cb
    Reviewed-on: https://go-review.googlesource.com/32162
    Run-TryBot: Martin Möhrmann <martisch@uos.de>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>

commit 023556c07166be15a914d1f828d8c7b20a59a804
Author: Ian Lance Taylor <iant@golang.org>
Date:   Fri Oct 28 18:25:31 2016 -0400

    time: clarify Equal docs
    
    The docs used to imply that using == would compare Locations, but of
    course it just compares Location pointers, which will have unpredictable
    results depending on how the pointers are loaded.
    
    Change-Id: I783c1309e476a9616a1c1c290eac713aba3b0b57
    Reviewed-on: https://go-review.googlesource.com/32332
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 9575c580648d20ded1b538d6e05a3032fff2aaed
Author: Mikio Hara <mikioh.mikioh@gmail.com>
Date:   Fri Oct 28 05:57:55 2016 +0900

    net: use IPv4 reserved address blocks for documentation
    
    Updates #15228.
    
    Change-Id: Iefdffa146703ee1c04afc2b71d9de1f0a0811f86
    Reviewed-on: https://go-review.googlesource.com/32146
    Run-TryBot: Mikio Hara <mikioh.mikioh@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 69b7fe1a9035d197e5f8040262e8ac335b66f9f8
Author: Mikio Hara <mikioh.mikioh@gmail.com>
Date:   Fri Oct 28 06:20:44 2016 +0900

    net: deflake TestLookupNonLDH
    
    Fixes #17623.
    
    Change-Id: I4717e8399f955c9be7ba19108bb0bcc108187c04
    Reviewed-on: https://go-review.googlesource.com/32147
    Run-TryBot: Mikio Hara <mikioh.mikioh@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit a1b6e1692b063488cfcc51c258b159ccce4f7d23
Author: Peter Weinberger <pjw@google.com>
Date:   Fri Oct 28 15:12:18 2016 -0400

    runtime: ensure elapsed cycles are not negative
    
    On solaris/amd64 sometimes the reported cycle count is negative. Replace
    with 0.
    
    Change-Id: I364eea5ca072281245c7ab3afb0bf69adc3a8eae
    Reviewed-on: https://go-review.googlesource.com/32258
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit ec5b6406b76462a1a97ce19f86c5c23ac1d2c830
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Fri Oct 28 14:22:13 2016 -0700

    cmd/compile: improve not enough / too many arguments errors
    
    Use "have" and "want" and multiple lines like other similar error
    messages. Also, fix handling of ... and multi-value function calls.
    
    Fixes #17650.
    
    Change-Id: I4850e79c080eac8df3b92a4accf9e470dff63c9a
    Reviewed-on: https://go-review.googlesource.com/32261
    Reviewed-by: Robert Griesemer <gri@golang.org>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 1bd39e79dbc146ae953284f82febf7d1fb461f4e
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 28 17:18:36 2016 -0400

    runtime: fix SP adjustment on amd64p32
    
    On amd64p32, rt0_go attempts to reserve 128 bytes of scratch space on
    the stack, but due to a register mixup this ends up being a no-op. Fix
    this so we actually reserve the stack space.
    
    Change-Id: I04dbfbeb44f3109528c8ec74e1136bc00d7e1faa
    Reviewed-on: https://go-review.googlesource.com/32331
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit bd640c882a8dcb88a0497770f881bce48ab83102
Author: Austin Clements <austin@google.com>
Date:   Sun Oct 23 11:07:49 2016 -0400

    runtime: disable stack rescanning by default
    
    With the hybrid barrier in place, we can now disable stack rescanning
    by default. This commit adds a "gcrescanstacks" GODEBUG variable that
    is off by default but can be set to re-enable STW stack rescanning.
    The plan is to leave this off but available in Go 1.8 for debugging
    and as a fallback.
    
    With this change, worst-case mark termination time at GOMAXPROCS=12
    *not* including time spent stopping the world (which is still
    unbounded) is reliably under 100 µs, with a 95%ile around 50 µs in
    every benchmark I tried (the go1 benchmarks, the x/benchmarks garbage
    benchmark, and the gcbench activegs and rpc benchmarks). Including
    time spent stopping the world usually adds about 20 µs to total STW
    time at GOMAXPROCS=12, but I've seen it add around 150 µs in these
    benchmarks when a goroutine takes time to reach a safe point (see
    issue #10958) or when stopping the world races with goroutine
    switches. At GOMAXPROCS=1, where this isn't an issue, worst case STW
    is typically 30 µs.
    
    The go-gcbench activegs benchmark is designed to stress large numbers
    of dirty stacks. This commit reduces 95%ile STW time for 500k dirty
    stacks by nearly three orders of magnitude, from 150ms to 195µs.
    
    This has little effect on the throughput of the go1 benchmarks or the
    x/benchmarks benchmarks.
    
    name         old time/op  new time/op  delta
    XGarbage-12  2.31ms ± 0%  2.32ms ± 1%  +0.28%  (p=0.001 n=17+16)
    XJSON-12     12.4ms ± 0%  12.4ms ± 0%  +0.41%  (p=0.000 n=18+18)
    XHTTP-12     11.8µs ± 0%  11.8µs ± 1%    ~     (p=0.492 n=20+18)
    
    It reduces the tail latency of the x/benchmarks HTTP benchmark:
    
    name      old p50-time  new p50-time  delta
    XHTTP-12    489µs ± 0%    491µs ± 1%  +0.54%  (p=0.000 n=20+18)
    
    name      old p95-time  new p95-time  delta
    XHTTP-12    957µs ± 1%    960µs ± 1%  +0.28%  (p=0.002 n=20+17)
    
    name      old p99-time  new p99-time  delta
    XHTTP-12   1.76ms ± 1%   1.64ms ± 1%  -7.20%  (p=0.000 n=20+18)
    
    Comparing to the beginning of the hybrid barrier implementation
    ("runtime: parallelize STW mcache flushing") shows that the hybrid
    barrier trades a small performance impact for much better STW latency,
    as expected. The magnitude of the performance impact is generally
    small:
    
    name                      old time/op    new time/op    delta
    BinaryTree17-12              2.37s ± 1%     2.42s ± 1%  +2.04%  (p=0.000 n=19+18)
    Fannkuch11-12                2.84s ± 0%     2.72s ± 0%  -4.00%  (p=0.000 n=19+19)
    FmtFprintfEmpty-12          44.2ns ± 1%    45.2ns ± 1%  +2.20%  (p=0.000 n=17+19)
    FmtFprintfString-12          130ns ± 1%     134ns ± 0%  +2.94%  (p=0.000 n=18+16)
    FmtFprintfInt-12             114ns ± 1%     117ns ± 0%  +3.01%  (p=0.000 n=19+15)
    FmtFprintfIntInt-12          176ns ± 1%     182ns ± 0%  +3.17%  (p=0.000 n=20+15)
    FmtFprintfPrefixedInt-12     186ns ± 1%     187ns ± 1%  +1.04%  (p=0.000 n=20+19)
    FmtFprintfFloat-12           251ns ± 1%     250ns ± 1%  -0.74%  (p=0.000 n=17+18)
    FmtManyArgs-12               746ns ± 1%     761ns ± 0%  +2.08%  (p=0.000 n=19+20)
    GobDecode-12                6.57ms ± 1%    6.65ms ± 1%  +1.11%  (p=0.000 n=19+20)
    GobEncode-12                5.59ms ± 1%    5.65ms ± 0%  +1.08%  (p=0.000 n=17+17)
    Gzip-12                      223ms ± 1%     223ms ± 1%  -0.31%  (p=0.006 n=20+20)
    Gunzip-12                   38.0ms ± 0%    37.9ms ± 1%  -0.25%  (p=0.009 n=19+20)
    HTTPClientServer-12         77.5µs ± 1%    78.9µs ± 2%  +1.89%  (p=0.000 n=20+20)
    JSONEncode-12               14.7ms ± 1%    14.9ms ± 0%  +0.75%  (p=0.000 n=20+20)
    JSONDecode-12               53.0ms ± 1%    55.9ms ± 1%  +5.54%  (p=0.000 n=19+19)
    Mandelbrot200-12            3.81ms ± 0%    3.81ms ± 1%  +0.20%  (p=0.023 n=17+19)
    GoParse-12                  3.17ms ± 1%    3.18ms ± 1%    ~     (p=0.057 n=20+19)
    RegexpMatchEasy0_32-12      71.7ns ± 1%    70.4ns ± 1%  -1.77%  (p=0.000 n=19+20)
    RegexpMatchEasy0_1K-12       946ns ± 0%     946ns ± 0%    ~     (p=0.405 n=18+18)
    RegexpMatchEasy1_32-12      67.2ns ± 2%    67.3ns ± 2%    ~     (p=0.732 n=20+20)
    RegexpMatchEasy1_1K-12       374ns ± 1%     378ns ± 1%  +1.14%  (p=0.000 n=18+19)
    RegexpMatchMedium_32-12      107ns ± 1%     107ns ± 1%    ~     (p=0.259 n=18+20)
    RegexpMatchMedium_1K-12     34.2µs ± 1%    34.5µs ± 1%  +1.03%  (p=0.000 n=18+18)
    RegexpMatchHard_32-12       1.77µs ± 1%    1.79µs ± 1%  +0.73%  (p=0.000 n=19+18)
    RegexpMatchHard_1K-12       53.6µs ± 1%    54.2µs ± 1%  +1.10%  (p=0.000 n=19+19)
    Template-12                 61.5ms ± 1%    63.9ms ± 0%  +3.96%  (p=0.000 n=18+18)
    TimeParse-12                 303ns ± 1%     300ns ± 1%  -1.08%  (p=0.000 n=19+20)
    TimeFormat-12                318ns ± 1%     320ns ± 0%  +0.79%  (p=0.000 n=19+19)
    Revcomp-12 (*)               509ms ± 3%     504ms ± 0%    ~     (p=0.967 n=7+12)
    [Geo mean]                  54.3µs         54.8µs       +0.88%
    
    (*) Revcomp is highly non-linear, so I only took samples with 2
    iterations.
    
    name         old time/op  new time/op  delta
    XGarbage-12  2.25ms ± 0%  2.32ms ± 1%  +2.74%  (p=0.000 n=16+16)
    XJSON-12     11.6ms ± 0%  12.4ms ± 0%  +6.81%  (p=0.000 n=18+18)
    XHTTP-12     11.6µs ± 1%  11.8µs ± 1%  +1.62%  (p=0.000 n=17+18)
    
    Updates #17503.
    
    Updates #17099, since you can't have a rescan list bug if there's no
    rescan list. I'm not marking it as fixed, since gcrescanstacks can
    still be set to re-enable the rescan lists.
    
    Change-Id: I6e926b4c2dbd4cd56721869d4f817bdbb330b851
    Reviewed-on: https://go-review.googlesource.com/31766
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 5380b22991dfb5f3bad25cd2e29f59fd07716581
Author: Austin Clements <austin@google.com>
Date:   Sun Oct 23 11:03:56 2016 -0400

    runtime: implement unconditional hybrid barrier
    
    This implements the unconditional version of the hybrid deletion write
    barrier, which always shades both the old and new pointer. It's
    unconditional for now because barriers on channel operations require
    checking both the source and destination stacks and we don't have a
    way to funnel this information into the write barrier at the moment.
    
    As part of this change, we modify the typed memclr operations
    introduced earlier to invoke the write barrier.
    
    This has basically no overall effect on benchmark performance. This is
    good, since it indicates that neither the extra shade nor the new bulk
    clear barriers have much effect. It also has little effect on latency.
    This is expected, since we haven't yet modified mark termination to
    take advantage of the hybrid barrier.
    
    Updates #17503.
    
    Change-Id: Iebedf84af2f0e857bd5d3a2d525f760b5cf7224b
    Reviewed-on: https://go-review.googlesource.com/31765
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit ee3d20129a89047ccb4a4e157688d2f24db8f343
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 26 17:05:41 2016 -0400

    runtime: avoid getfull() barrier most of the time
    
    With the hybrid barrier, unless we're doing a STW GC or hit a very
    rare race (~once per all.bash) that can start mark termination before
    all of the work is drained, we don't need to drain the work queue at
    all. Even draining an empty work queue is rather expensive since we
    have to enter the getfull() barrier, so it's worth avoiding this.
    
    Conveniently, it's quite easy to detect whether or not we actually
    need the getufull() barrier: since the world is stopped when we enter
    mark termination, everything must have flushed its work to the work
    queue, so we can just check the queue. If the queue is empty and we
    haven't queued up any jobs that may create more work (which should
    always be the case with the hybrid barrier), we can simply have all GC
    workers perform non-blocking drains.
    
    Also conveniently, this solution is quite safe. If we do somehow screw
    something up and there's work on the work queue, some worker will
    still process it, it just may not happen in parallel.
    
    This is not the "right" solution, but it's simple, expedient,
    low-risk, and maintains compatibility with debug.gcrescanstacks. When
    we remove the gcrescanstacks fallback in Go 1.9, we should also fix
    the race that starts mark termination early, and then we can eliminate
    work draining from mark termination.
    
    Updates #17503.
    
    Change-Id: I7b3cd5de6a248ab29d78c2b42aed8b7443641361
    Reviewed-on: https://go-review.googlesource.com/32186
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit d8256824ac39e4badb14feffe94f4342a0bd21b3
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 24 17:56:00 2016 -0400

    runtime: remove unnecessary step from bulkBarrierPreWrite
    
    Currently bulkBarrierPreWrite calls writebarrierptr_prewrite, but this
    means that we check writeBarrier.needed twice and perform cgo checks
    twice.
    
    Change bulkBarrierPreWrite to call writebarrierptr_prewrite1 to skip
    over these duplicate checks.
    
    This may speed up bulkBarrierPreWrite slightly, but mostly this will
    save us from running out of nosplit stack space on ppc64x in the near
    future.
    
    Updates #17503.
    
    Change-Id: I1cea1a2207e884ab1a279c6a5e378dcdc048b63e
    Reviewed-on: https://go-review.googlesource.com/31890
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 70c107c68dca7d57a24b35dd81420fb889aa1031
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 19 15:49:31 2016 -0400

    runtime: add deletion barriers on gobuf.ctxt
    
    gobuf.ctxt is set to nil from many places in assembly code and these
    assignments require write barriers with the hybrid barrier.
    
    Conveniently, in most of these places ctxt should already be nil, in
    which case we don't need the barrier. This commit changes these places
    to assert that ctxt is already nil.
    
    gogo is more complicated, since ctxt may not already be nil. For gogo,
    we manually perform the write barrier if ctxt is not nil.
    
    Updates #17503.
    
    Change-Id: I9d75e27c75a1b7f8b715ad112fc5d45ffa856d30
    Reviewed-on: https://go-review.googlesource.com/31764
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 8f81dfe8b47e975b90bb4a2f8dd314d32c633176
Author: Austin Clements <austin@google.com>
Date:   Mon Aug 22 16:02:54 2016 -0400

    runtime: perform write barrier before pointer write
    
    Currently, we perform write barriers after performing pointer writes.
    At the moment, it simply doesn't matter what order this happens in, as
    long as they appear atomic to GC. But both the hybrid barrier and ROC
    are going to require a pre-write write barrier.
    
    For the hybrid barrier, this is important because the barrier needs to
    observe both the current value of the slot and the value that will be
    written to it. (Alternatively, the caller could do the write and pass
    in the old value, but it seems easier and more useful to just swap the
    order of the barrier and the write.)
    
    For ROC, this is necessary because, if the pointer write is going to
    make the pointer reachable to some goroutine that it currently is not
    visible to, the garbage collector must take some special action before
    that pointer becomes more broadly visible.
    
    This commits swaps pointer writes around so the write barrier occurs
    before the pointer write.
    
    The main subtlety here is bulk memory writes. Currently, these copy to
    the destination first and then use the pointer bitmap of the
    destination to find the copied pointers and invoke the write barrier.
    This is necessary because the source may not have a pointer bitmap. To
    handle these, we pass both the source and the destination to the bulk
    memory barrier, which uses the pointer bitmap of the destination, but
    reads the pointer values from the source.
    
    Updates #17503.
    
    Change-Id: I78ecc0c5c94ee81c29019c305b3d232069294a55
    Reviewed-on: https://go-review.googlesource.com/31763
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 0f06d0a051714d14b923b0a9164ab1b3f463aa74
Author: Russ Cox <rsc@golang.org>
Date:   Fri Oct 21 12:04:31 2016 -0400

    cmd/go: apply import restrictions to test code too
    
    We reject import of main packages, but we missed tests.
    Reject in all tests except test of that main package.
    
    We reject local (relative) imports from code with a
    non-local import path, but again we missed tests.
    Reject those too.
    
    Fixes #14811.
    Fixes #15795.
    Fixes #17475.
    
    Change-Id: I535ff26889520276a891904f54f1a85b2c40207d
    Reviewed-on: https://go-review.googlesource.com/31821
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 91c1cdfbdbecbc33ad396f55d9e8b5619959fde1
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Fri Oct 28 13:16:25 2016 -0700

    cmd/compile: add Param to Sizeof test
    
    Change-Id: I2a710f0e9b484b3dfc581d3a9a23aa13321ec267
    Reviewed-on: https://go-review.googlesource.com/32316
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit a866df26711c615dfe92ab1b00d256d3d1085f0e
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Oct 26 18:10:40 2016 -0400

    cmd/internal/obj/arm64: materialize float constant 0 from zero register
    
    Materialize float constant 0 from integer zero register, instead
    of loading from constant pool.
    
    Also fix assembling FMOV from zero register to FP register.
    
    Change-Id: Ie413dd342cedebdb95ba8cfc220e23ed2a39e885
    Reviewed-on: https://go-review.googlesource.com/32250
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit 9d1efba28db4c045356c92c20f98cf12b5f31d72
Author: Cherry Zhang <cherryyz@google.com>
Date:   Thu Oct 27 14:33:58 2016 -0400

    cmd/link: put text at address 0x1000000 on darwin/amd64
    
    Apparently on macOS Sierra LLDB thinks /usr/lib/dyld is mapped
    at address 0, even if Go code starts at 0x1000, and it looks up
    addresses from dyld which shadows Go symbols. Move Go binary at
    a higher address to avoid clash.
    
    Fixes #17463. Re-enable TestLldbPython.
    
    Change-Id: I89ca6f3ee48aa6da9862bfa0c2da91477cc93255
    Reviewed-on: https://go-review.googlesource.com/32185
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit c39918a04991387f14cab1204f54fafab81bc105
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 18 10:26:28 2016 -0400

    cmd/compile: disable various write barrier optimizations
    
    Several of our current write barrier elision optimizations are invalid
    with the hybrid barrier. Eliding the hybrid barrier requires that
    *both* the current and new pointer be already shaded and, since we
    don't have the flow analysis to figure out anything about the slot's
    current value, for now we have to just disable several of these
    optimizations.
    
    This has a slight impact on binary size. On linux/amd64, the go tool
    binary increases by 0.7% and the compile binary increases by 1.5%.
    
    It also has a slight impact on performance, as one would expect. We'll
    win some of this back in subsequent commits.
    
    name                      old time/op    new time/op    delta
    BinaryTree17-12              2.38s ± 1%     2.40s ± 1%  +0.82%  (p=0.000 n=18+20)
    Fannkuch11-12                2.84s ± 1%     2.70s ± 0%  -4.97%  (p=0.000 n=18+18)
    FmtFprintfEmpty-12          44.2ns ± 1%    46.4ns ± 2%  +4.89%  (p=0.000 n=16+18)
    FmtFprintfString-12          131ns ± 0%     134ns ± 1%  +2.05%  (p=0.000 n=12+19)
    FmtFprintfInt-12             114ns ± 1%     117ns ± 1%  +3.26%  (p=0.000 n=19+20)
    FmtFprintfIntInt-12          176ns ± 1%     181ns ± 1%  +3.25%  (p=0.000 n=20+20)
    FmtFprintfPrefixedInt-12     185ns ± 1%     190ns ± 1%  +2.77%  (p=0.000 n=19+18)
    FmtFprintfFloat-12           249ns ± 1%     254ns ± 1%  +1.71%  (p=0.000 n=18+20)
    FmtManyArgs-12               747ns ± 1%     743ns ± 1%  -0.58%  (p=0.000 n=19+18)
    GobDecode-12                6.57ms ± 1%    6.61ms ± 0%  +0.73%  (p=0.000 n=19+20)
    GobEncode-12                5.58ms ± 1%    5.60ms ± 0%  +0.27%  (p=0.001 n=18+18)
    Gzip-12                      223ms ± 1%     223ms ± 1%    ~     (p=0.351 n=19+20)
    Gunzip-12                   37.9ms ± 0%    37.9ms ± 1%    ~     (p=0.095 n=16+20)
    HTTPClientServer-12         77.8µs ± 1%    78.5µs ± 1%  +0.97%  (p=0.000 n=19+20)
    JSONEncode-12               14.8ms ± 1%    14.8ms ± 1%    ~     (p=0.079 n=20+19)
    JSONDecode-12               53.7ms ± 1%    54.2ms ± 1%  +0.92%  (p=0.000 n=20+19)
    Mandelbrot200-12            3.81ms ± 1%    3.81ms ± 0%    ~     (p=0.916 n=19+18)
    GoParse-12                  3.19ms ± 1%    3.19ms ± 1%    ~     (p=0.175 n=20+19)
    RegexpMatchEasy0_32-12      71.9ns ± 1%    70.6ns ± 1%  -1.87%  (p=0.000 n=19+20)
    RegexpMatchEasy0_1K-12       946ns ± 0%     944ns ± 0%  -0.22%  (p=0.000 n=19+16)
    RegexpMatchEasy1_32-12      67.3ns ± 2%    66.8ns ± 1%  -0.72%  (p=0.008 n=20+20)
    RegexpMatchEasy1_1K-12       374ns ± 1%     384ns ± 1%  +2.69%  (p=0.000 n=18+20)
    RegexpMatchMedium_32-12      107ns ± 1%     107ns ± 1%    ~     (p=1.000 n=20+20)
    RegexpMatchMedium_1K-12     34.3µs ± 1%    34.6µs ± 1%  +0.90%  (p=0.000 n=20+20)
    RegexpMatchHard_32-12       1.78µs ± 1%    1.80µs ± 1%  +1.45%  (p=0.000 n=20+19)
    RegexpMatchHard_1K-12       53.6µs ± 0%    54.5µs ± 1%  +1.52%  (p=0.000 n=19+18)
    Revcomp-12                   417ms ± 5%     391ms ± 1%  -6.42%  (p=0.000 n=16+19)
    Template-12                 61.1ms ± 1%    64.2ms ± 0%  +5.07%  (p=0.000 n=19+20)
    TimeParse-12                 302ns ± 1%     305ns ± 1%  +0.90%  (p=0.000 n=18+18)
    TimeFormat-12                319ns ± 1%     315ns ± 1%  -1.25%  (p=0.000 n=18+18)
    [Geo mean]                  54.0µs         54.3µs       +0.58%
    
    name         old time/op  new time/op  delta
    XGarbage-12  2.24ms ± 2%  2.28ms ± 1%  +1.68%  (p=0.000 n=18+17)
    XHTTP-12     11.4µs ± 1%  11.6µs ± 2%  +1.63%  (p=0.000 n=18+18)
    XJSON-12     11.6ms ± 0%  12.5ms ± 0%  +7.84%  (p=0.000 n=18+17)
    
    Updates #17503.
    
    Change-Id: I1899f8e35662971e24bf692b517dfbe2b533c00c
    Reviewed-on: https://go-review.googlesource.com/31572
    Reviewed-by: Keith Randall <khr@golang.org>

commit c3163d23f038a595dc4dd8e1218f412a443a39fa
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 19 16:16:40 2016 -0400

    runtime: eliminate write barriers from save
    
    As for dropg, save is writing a nil pointer that will generate a write
    barrier with the hybrid barrier. However, in this case, ctxt always
    should already be nil, so replace the write with an assertion that
    this is the case.
    
    At this point, we're ready to disable the write barrier elision
    optimizations that interfere with the hybrid barrier.
    
    Updates #17503.
    
    Change-Id: I83208e65aa33403d442401f355b2e013ab9a50e9
    Reviewed-on: https://go-review.googlesource.com/31571
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 8044b77a57f9d22e0815ed1476ffa8156b622862
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 19 16:00:07 2016 -0400

    runtime: eliminate write barriers from dropg
    
    Currently this contains no write barriers because it's writing nil
    pointers, but with the hybrid barrier, even these will produce write
    barriers. However, since these are *gs and *ms, they don't need write
    barriers, so we can simply eliminate them.
    
    Updates #17503.
    
    Change-Id: Ib188a60492c5cfb352814bf9b2bcb2941fb7d6c0
    Reviewed-on: https://go-review.googlesource.com/31570
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 85c22bc3a5e9ce03cd0ca668285755ce430456e0
Author: Austin Clements <austin@google.com>
Date:   Fri Sep 9 09:34:26 2016 -0400

    runtime: mark tiny blocks at GC start
    
    The hybrid barrier requires allocate-black, but there's one case where
    we don't currently allocate black: the tiny allocator. If we allocate
    a *new* tiny alloc block during GC, it will be allocated black, but if
    we allocated the current block before GC, it won't be black, and the
    further allocations from it won't mark it, which means we may free a
    reachable tiny block during sweeping.
    
    Fix this by passing over all mcaches at the beginning of mark, while
    the world is still stopped, and greying their tiny blocks.
    
    Updates #17503.
    
    Change-Id: I04d4df7cc2f553f8f7b1e4cb0b52e2946588111a
    Reviewed-on: https://go-review.googlesource.com/31456
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit ee785f03a24e0373be4c2d7256413296735c3414
Author: Austin Clements <austin@google.com>
Date:   Thu Oct 13 15:34:56 2016 -0400

    runtime: shade stack-to-stack copy when starting a goroutine
    
    The hybrid barrier requires barriers on stack-to-stack copies if
    either stack is grey. There are only two instances of this in the
    runtime: channel sends and starting a goroutine. Channel sends already
    use typedmemmove and hence have the necessary barriers. This commits
    adds barriers for the stack-to-stack copy when starting a goroutine.
    
    Updates #17503.
    
    Change-Id: Ibb55e08127ca4d021ac54be61cb96732efa5df5b
    Reviewed-on: https://go-review.googlesource.com/31455
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 0c0960a2349d00369f7e1781ec3d8b04d96a5b80
Author: Michael Matloob <matloob@golang.org>
Date:   Fri Oct 28 15:58:44 2016 -0400

    runtime/pprof/internal/profile: add copyright notice to profile_memmap.go
    
    Change-Id: Ia511b0aadc87eb53e084d14cdb90ba4be958a43e
    Reviewed-on: https://go-review.googlesource.com/32259
    Reviewed-by: Austin Clements <austin@google.com>

commit b33030a72754cb55d6ec137e79facacb398c9be4
Author: Michael Matloob <matloob@golang.org>
Date:   Fri Oct 28 15:28:18 2016 -0400

    runtime/pprof: write profiles in protobuf format.
    
    Original Change by Daria Kolistratova <daria.kolistratova@intel.com>
    
    Added functions with suffix proto and stuff from pprof tool to translate
    to protobuf. Done as the profile proto is more extensible than the legacy
    pprof format and is pprof's preferred profile format. Large part was taken
    from https://github.com/google/pprof tool. Tested by hand and compared the
    result with translated by pprof tool, profiles are identical.
    Fixes #16093
    
    Change-Id: I2751345b09a66ee2b6aa64be76cba4cd1c326aa6
    Reviewed-on: https://go-review.googlesource.com/32257
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Alan Donovan <adonovan@google.com>

commit 30651b3bbbfda86e8188dfd89cb326a4db085e25
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 12:22:16 2016 -0400

    encoding/csv: document Read error behavior
    
    Fixes #17342.
    
    Change-Id: I76af756d7aff464554c5564d444962a468d0eccc
    Reviewed-on: https://go-review.googlesource.com/32172
    Run-TryBot: Russ Cox <rsc@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit e2bcae7875e37c13f92dc3cf16614bf7e70fa6c8
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 13:06:37 2016 -0400

    cmd/go, go/build: document form of import paths
    
    Fixes #16164.
    
    Change-Id: Ic8f51ebd8235640143913a07b70f5b41ee061fe4
    Reviewed-on: https://go-review.googlesource.com/32114
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 2a7272b42230c0d55c1ec243d123fea9ba035063
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 22:18:02 2016 -0400

    runtime/trace: deflake TestTraceSymbolize
    
    Waiting 2ms for all the kicked-off goroutines to run and block
    seems a little optimistic. No harm done by waiting for 200ms instead.
    
    Fixes #17238.
    
    Change-Id: I827532ea2f5f1f3ed04179f8957dd2c563946ed0
    Reviewed-on: https://go-review.googlesource.com/32103
    Run-TryBot: Russ Cox <rsc@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 3366d6a39bbaaa011a11c651975a88d9f05e00b6
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 22:02:12 2016 -0400

    os: adjust (*File).Read comment
    
    Fixes #6639.
    
    Change-Id: Iefce87c5521504fd41843df8462cfd840c24410f
    Reviewed-on: https://go-review.googlesource.com/32102
    Run-TryBot: Russ Cox <rsc@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>

commit bd8103d50b5e576610709738d9e3138ae7887c28
Author: Quentin Smith <quentin@golang.org>
Date:   Fri Oct 21 16:34:40 2016 -0400

    os/exec: document how Command fills in Cmd.Args
    
    Fixes #17536
    
    Change-Id: Ica8c3d696848822ac65b7931455b1fd94809bfe8
    Reviewed-on: https://go-review.googlesource.com/31710
    Reviewed-by: Russ Cox <rsc@golang.org>

commit 88518e7dd6a118167aa71851a3a9f24d0230bc82
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 26 14:34:20 2016 -0400

    runtime: zero-initialize LR on new stacks
    
    Currently we initialize LR on a new stack by writing nil to it. But
    this is an initializing write since the newly allocated stack is not
    zeroed, so this is unsafe with the hybrid barrier. Change this is a
    uintptr write to avoid a bad write barrier.
    
    Updates #17503.
    
    Change-Id: I062ac352e35df7da4644c1f2a5aaab87049d1f60
    Reviewed-on: https://go-review.googlesource.com/32093
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit d3836aba316a6a5ee9410b9abd2f42120af4ffe6
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 14 13:39:07 2016 -0400

    runtime: ensure finalizers are zero-initialized before reuse
    
    We reuse finalizers in finblocks, which are allocated off-heap. This
    means they have to be zero-initialized before becoming visible to the
    garbage collector. We actually already do this by clearing the
    finalizer before returning it to the pool, but we're not careful to
    enforce correct memory ordering. Fix this by manipulating the
    finalizer count atomically so these writes synchronize properly with
    the garbage collector.
    
    Updates #17503.
    
    Change-Id: I7797d31df3c656c9fe654bc6da287f66a9e2037d
    Reviewed-on: https://go-review.googlesource.com/31454
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit db56a63547d7ae9f19afd2497c67f717154f9115
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 3 14:45:52 2016 -0400

    runtime: avoid write barriers to uninitialized finalizer frame memory
    
    runfinq allocates a stack frame on the heap for constructing the
    finalizer function calls and reuses it for each call. However, because
    the type of this frame is constantly shifting, it tells mallocgc there
    are no pointers in it and it acts essentially like uninitialized
    memory between uses. But runfinq uses pointer writes with write
    barriers to "initialize" this memory, which is not going to be safe
    with the hybrid barrier, since the hybrid barrier may see a stale
    pointer left in the "uninitialized" frame.
    
    Fix this by zero-initializing the argument values in the frame before
    writing the argument pointers.
    
    Updates #17503.
    
    Change-Id: I951c0a2be427eb9082a32d65c4410e6fdef041be
    Reviewed-on: https://go-review.googlesource.com/31453
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit c5e7006540ca949b481a0477d1308e1373dd5c31
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 14 14:06:38 2016 -0400

    runtime: document rules about unmanaged memory
    
    Updates #17503.
    
    Change-Id: I109d8742358ae983fdff3f3dbb7136973e81f4c3
    Reviewed-on: https://go-review.googlesource.com/31452
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 8a7f0ad0b5b08faa09751b5528e5fa8831745aea
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 18 11:06:28 2016 -0400

    cmd/compile: use typedmemclr for zeroing if there are pointers
    
    Currently, zeroing generates an ssa.OpZero, which never has write
    barriers, even if the assignment is an OASWB. The hybrid barrier
    requires write barriers on zeroing, so change OASWB to generate an
    ssa.OpZeroWB when assigning the zero value, which turns into a
    typedmemclr.
    
    Updates #17503.
    
    Change-Id: Ib37ac5e39f578447dbd6b36a6a54117d5624784d
    Reviewed-on: https://go-review.googlesource.com/31451
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 58e2edafb718718225056530a7a09ee3e08a96d1
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 18 10:01:56 2016 -0400

    cmd/compile: lower slice clears to memclrHasPointers
    
    If a slice's backing store has pointers, we need to lower clears of
    that slice to memclrHasPointers instead of memclrNoHeapPointers.
    
    Updates #17503.
    
    Change-Id: I20750e4bf57f7b8862f3d898bfb32d964b91d07b
    Reviewed-on: https://go-review.googlesource.com/31450
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit ef3df18944d2d210f99de88fee01414ab1fa8f66
Author: Russ Cox <rsc@golang.org>
Date:   Tue Oct 25 23:15:30 2016 -0400

    mime/multipart: simplify Part.Read
    
    The basic structure of Part.Read should be simple:
    do what you can with the current buffered data,
    reading more as you need it. Make it that way.
    
    Working entirely in the bufio.Reader's buffer eliminates
    the need for an additional bytes.Buffer.
    
    This structure should be easier to extend in the future as
    more special cases arise.
    
    Change-Id: I83cb24a755a1767c4c037f9ece6716460c3ecd01
    Reviewed-on: https://go-review.googlesource.com/32092
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 14f3284ddb682ccf111716b50f43dc6ee072cf4c
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 28 18:40:38 2016 +0000

    Revert "runtime/pprof: write profiles in protobuf format."
    
    This reverts commit 7d14401bcbee4a8ff33ac869ef5ebb156a179ab6.
    
    Reason for revert: Doesn't build.
    
    Change-Id: I766179ab9225109d9232f783326e4d3843254980
    Reviewed-on: https://go-review.googlesource.com/32256
    Reviewed-by: Russ Cox <rsc@golang.org>

commit eb88b3eefa113f67e7cf72dfd085f65bbd125179
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 20:23:03 2016 -0400

    net: add (*UnixListener).SetUnlinkOnClose
    
    Let users control whether unix listener socket file is unlinked on close.
    
    Fixes #13877.
    
    Change-Id: I9d1cb47e31418d655f164d15c67e188656a67d1c
    Reviewed-on: https://go-review.googlesource.com/32099
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 13558c41ffa29d0af80e7e06d08af8eb0f0055fb
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 20:13:33 2016 -0400

    net: only remove Unix domain socket file on the first call to Close
    
    Fixes #17131.
    
    Change-Id: I60b381687746fadce12ef18a190cbe3f435172f2
    Reviewed-on: https://go-review.googlesource.com/32098
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 87e48c5afdcf5e01bb2b7f51b7643e8901f4b7f9
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 17 18:41:56 2016 -0400

    runtime, cmd/compile: rename memclr -> memclrNoHeapPointers
    
    Since barrier-less memclr is only safe in very narrow circumstances,
    this commit renames memclr to avoid accidentally calling memclr on
    typed memory. This can cause subtle, non-deterministic bugs, so it's
    worth some effort to prevent. In the near term, this will also prevent
    bugs creeping in from any concurrent CLs that add calls to memclr; if
    this happens, whichever patch hits master second will fail to compile.
    
    This also adds the other new memclr variants to the compiler's
    builtin.go to minimize the churn on that binary blob. We'll use these
    in future commits.
    
    Updates #17503.
    
    Change-Id: I00eead049f5bd35ca107ea525966831f3d1ed9ca
    Reviewed-on: https://go-review.googlesource.com/31369
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit ae3bb4a537c84e43be2ed7b79e84450332aafe2d
Author: Austin Clements <austin@google.com>
Date:   Sun Sep 25 17:12:43 2016 -0400

    runtime: make fixalloc zero allocations on reuse
    
    Currently fixalloc does not zero memory it reuses. This is dangerous
    with the hybrid barrier if the type may contain heap pointers, since
    it may cause us to observe a dead heap pointer on reuse. It's also
    error-prone since it's the only allocator that doesn't zero on
    allocation (mallocgc of course zeroes, but so do persistentalloc and
    sysAlloc). It's also largely pointless: for mcache, the caller
    immediately memclrs the allocation; and the two specials types are
    tiny so there's no real cost to zeroing them.
    
    Change fixalloc to zero allocations by default.
    
    The only type we don't zero by default is mspan. This actually
    requires that the spsn's sweepgen survive across freeing and
    reallocating a span. If we were to zero it, the following race would
    be possible:
    
    1. The current sweepgen is 2. Span s is on the unswept list.
    
    2. Direct sweeping sweeps span s, finds it's all free, and releases s
       to the fixalloc.
    
    3. Thread 1 allocates s from fixalloc. Suppose this zeros s, including
       s.sweepgen.
    
    4. Thread 1 calls s.init, which sets s.state to _MSpanDead.
    
    5. On thread 2, background sweeping comes across span s in allspans
       and cas's s.sweepgen from 0 (sg-2) to 1 (sg-1). Now it thinks it
       owns it for sweeping. 6. Thread 1 continues initializing s.
       Everything breaks.
    
    I would like to fix this because it's obviously confusing, but it's a
    subtle enough problem that I'm leaving it alone for now. The solution
    may be to skip sweepgen 0, but then we have to think about wrap-around
    much more carefully.
    
    Updates #17503.
    
    Change-Id: Ie08691feed3abbb06a31381b94beb0a2e36a0613
    Reviewed-on: https://go-review.googlesource.com/31368
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit f4dcc9b29b052b99b97d0e445cda589f08bfc798
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 18 17:29:37 2016 -0400

    runtime: make _MSpanDead be the zero state
    
    Currently the zero value of an mspan is in the "in use" state. This
    seems like a bad idea in general. But it's going to wreak havoc when
    we make fixalloc zero allocations: even "freed" mspan objects are
    still on the allspans list and still get looked at by the garbage
    collector. Hence, if we leave the mspan states the way they are,
    allocating a span that reuses old memory will temporarily pass that
    span (which is visible to GC!) through the "in use" state, which can
    cause "unswept span" panics.
    
    Fix all of this by making the zero state "dead".
    
    Updates #17503.
    
    Change-Id: I77c7ac06e297af4b9e6258bc091c37abe102acc3
    Reviewed-on: https://go-review.googlesource.com/31367
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit aa581f51570b1c35dc2648226fd8de861de526d4
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 17 17:00:05 2016 -0400

    runtime: use typedmemclr for typed memory
    
    The hybrid barrier requires distinguishing typed and untyped memory
    even when zeroing because the *current* contents of the memory matters
    even when overwriting.
    
    This commit introduces runtime.typedmemclr and runtime.memclrHasPointers
    as a typed memory clearing functions parallel to runtime.typedmemmove.
    Currently these simply call memclr, but with the hybrid barrier we'll
    need to shade any pointers we're overwriting. These will provide us
    with the necessary hooks to do so.
    
    Updates #17503.
    
    Change-Id: I74478619f8907825898092aaa204d6e4690f27e6
    Reviewed-on: https://go-review.googlesource.com/31366
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit a475a38a3dcd48541f60e40b1dac3c84ab72d0e5
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 25 13:56:37 2016 -0400

    runtime: parallelize STW mcache flushing
    
    Currently all mcaches are flushed in a single STW root job. This takes
    about 5 µs per P, but since it's done sequentially it adds about
    5*GOMAXPROCS µs to the STW.
    
    Fix this by parallelizing the job. Since there are exactly GOMAXPROCS
    mcaches to flush, this parallelizes quite nicely and brings the STW
    latency cost down to a constant 5 µs (assuming GOMAXPROCS actually
    reflects the number of CPUs).
    
    Updates #17503.
    
    Change-Id: Ibefeb1c2229975d5137c6e67fac3b6c92103742d
    Reviewed-on: https://go-review.googlesource.com/32033
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 20edeabc0fc73c6212769142f80e921c2e07ee08
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Thu Oct 27 20:15:29 2016 -0700

    cmd/compile: don't alloc Name/Param for unresolved syms
    
    ONONAME nodes generated from unresolved symbols don't need Params.
    They only need Names to store Iota; move Iota to Node.Xoffset.
    While we're here, change iota to int64 to reduce casting.
    
    Passes toolstash -cmp.
    
    name       old alloc/op     new alloc/op     delta
    Template       39.9MB ± 0%      39.7MB ± 0%  -0.39%        (p=0.000 n=19+20)
    Unicode        30.9MB ± 0%      30.7MB ± 0%  -0.35%        (p=0.000 n=20+20)
    GoTypes         119MB ± 0%       118MB ± 0%  -0.42%        (p=0.000 n=20+20)
    Compiler        464MB ± 0%       461MB ± 0%  -0.54%        (p=0.000 n=19+20)
    
    name       old allocs/op    new allocs/op    delta
    Template         386k ± 0%        383k ± 0%  -0.62%        (p=0.000 n=20+20)
    Unicode          323k ± 0%        321k ± 0%  -0.49%        (p=0.000 n=20+20)
    GoTypes         1.16M ± 0%       1.15M ± 0%  -0.67%        (p=0.000 n=20+20)
    Compiler        4.09M ± 0%       4.05M ± 0%  -0.95%        (p=0.000 n=20+20)
    
    Change-Id: Ib27219a0d0405def1b4dadacf64935ba12d10a94
    Reviewed-on: https://go-review.googlesource.com/32237
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 7d14401bcbee4a8ff33ac869ef5ebb156a179ab6
Author: unknown <daria.kolistratova@intel.com>
Date:   Fri Oct 7 18:21:03 2016 +0300

    runtime/pprof: write profiles in protobuf format.
    
    Added functions with suffix proto and stuff from pprof tool to translate
    to protobuf. Done as the profile proto is more extensible than the legacy
    pprof format and is pprof's preferred profile format. Large part was taken
    from https://github.com/google/pprof tool. Tested by hand and compared the
    result with translated by pprof tool, profiles are identical.
    Fixes #16093
    Change-Id: I5acdb2809cab0d16ed4694fdaa7b8ddfd68df11e
    Reviewed-on: https://go-review.googlesource.com/30556
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Michael Matloob <matloob@golang.org>

commit d70b0fe6c4d1b1369b742ea5b7d4e6f0c50ffdcb
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 28 11:14:07 2016 -0400

    runtime: fix preemption of root marking jobs
    
    The current logic in gcDrain conflates non-blocking with preemptible
    draining for root jobs. As a result, if you do a non-blocking (but
    *not* preemptible) drain, like dedicated workers do, the root job
    drain will stop if preempted and fall through to heap marking jobs,
    which won't stop until it fails to get a heap marking job.
    
    This commit fixes the condition on root marking jobs so they only stop
    when preempted if the drain is preemptible.
    
    Coincidentally, this also fixes a nil pointer dereference if we call
    gcDrain with gcDrainNoBlock and without a user G, since it tries to
    get the preempt flag from the nil user G. This combination never
    happens right now, but will in the future.
    
    Change-Id: Ia910ec20a9b46237f7926969144a33b1b4a7b2f9
    Reviewed-on: https://go-review.googlesource.com/32291
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

commit e14b02197737a0d7e5eed2856806cf20c85052cf
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 28 10:53:41 2016 -0400

    runtime/trace, internal/trace: script to collect canned traces
    
    This adds support to the runtime/trace test for saving traces
    collected by its tests to disk and a script in internal/trace that
    uses this to collect canned traces for the trace test suite. This can
    be used to add to the test suite when we introduce a new trace format
    version.
    
    Change-Id: Id9ac1ff312235bf02f982fdfff8a827f54035758
    Reviewed-on: https://go-review.googlesource.com/32290
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

commit 9a8c69539cbd052e2c4b55496d72ec8407c0af52
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Thu Oct 20 03:16:22 2016 -0700

    bytes, strings: optimize for ASCII sets
    
    In a large codebase within Google, there are thousands of uses of:
            ContainsAny|IndexAny|LastIndexAny|Trim|TrimLeft|TrimRight
    
    An analysis of their usage shows that over 97% of them only use character
    sets consisting of only ASCII symbols.
    
    Uses of ContainsAny|IndexAny|LastIndexAny:
             6% are 1   character  (e.g., "\n" or " ")
            58% are 2-4 characters (e.g., "<>" or "\r\n\t ")
            24% are 5-9 characters (e.g., "()[]*^$")
            10% are 10+ characters (e.g., "+-=&|><!(){}[]^\"~*?:\\/ ")
    We optimize for ASCII sets, which are commonly used to search for
    "control" characters in some string. We don't optimize for the
    single character scenario since IndexRune or IndexByte could be used.
    
    Uses of Trim|TrimLeft|TrimRight:
            71% are 1   character  (e.g., "\n" or " ")
            14% are 2   characters (e.g., "\r\n")
            10% are 3-4 characters (e.g., " \t\r\n")
             5% are 10+ characters (e.g., "0123456789abcdefABCDEF")
    We optimize for the single character case with a simple closured function
    that only checks for that character's value. We optimize for the medium
    and larger sets using a 16-byte bit-map representing a set of ASCII characters.
    
    The benchmarks below have the following suffix name "%d:%d" where the first
    number is the length of the input and the second number is the length
    of the charset.
    
    == bytes package ==
    benchmark                            old ns/op     new ns/op     delta
    BenchmarkIndexAnyASCII/1:1-4         5.09          5.23          +2.75%
    BenchmarkIndexAnyASCII/1:2-4         5.81          5.85          +0.69%
    BenchmarkIndexAnyASCII/1:4-4         7.22          7.50          +3.88%
    BenchmarkIndexAnyASCII/1:8-4         11.0          11.1          +0.91%
    BenchmarkIndexAnyASCII/1:16-4        17.5          17.8          +1.71%
    BenchmarkIndexAnyASCII/16:1-4        36.0          34.0          -5.56%
    BenchmarkIndexAnyASCII/16:2-4        46.6          36.5          -21.67%
    BenchmarkIndexAnyASCII/16:4-4        78.0          40.4          -48.21%
    BenchmarkIndexAnyASCII/16:8-4        136           47.4          -65.15%
    BenchmarkIndexAnyASCII/16:16-4       254           61.5          -75.79%
    BenchmarkIndexAnyASCII/256:1-4       542           388           -28.41%
    BenchmarkIndexAnyASCII/256:2-4       705           382           -45.82%
    BenchmarkIndexAnyASCII/256:4-4       1089          386           -64.55%
    BenchmarkIndexAnyASCII/256:8-4       1994          394           -80.24%
    BenchmarkIndexAnyASCII/256:16-4      3843          411           -89.31%
    BenchmarkIndexAnyASCII/4096:1-4      8522          5873          -31.08%
    BenchmarkIndexAnyASCII/4096:2-4      11253         5861          -47.92%
    BenchmarkIndexAnyASCII/4096:4-4      17824         5883          -66.99%
    BenchmarkIndexAnyASCII/4096:8-4      32053         5871          -81.68%
    BenchmarkIndexAnyASCII/4096:16-4     60512         5888          -90.27%
    BenchmarkTrimASCII/1:1-4             79.5          70.8          -10.94%
    BenchmarkTrimASCII/1:2-4             79.0          105           +32.91%
    BenchmarkTrimASCII/1:4-4             79.6          109           +36.93%
    BenchmarkTrimASCII/1:8-4             78.8          118           +49.75%
    BenchmarkTrimASCII/1:16-4            80.2          132           +64.59%
    BenchmarkTrimASCII/16:1-4            243           116           -52.26%
    BenchmarkTrimASCII/16:2-4            243           171           -29.63%
    BenchmarkTrimASCII/16:4-4            243           176           -27.57%
    BenchmarkTrimASCII/16:8-4            241           184           -23.65%
    BenchmarkTrimASCII/16:16-4           238           199           -16.39%
    BenchmarkTrimASCII/256:1-4           2580          840           -67.44%
    BenchmarkTrimASCII/256:2-4           2603          1175          -54.86%
    BenchmarkTrimASCII/256:4-4           2572          1188          -53.81%
    BenchmarkTrimASCII/256:8-4           2550          1191          -53.29%
    BenchmarkTrimASCII/256:16-4          2585          1208          -53.27%
    BenchmarkTrimASCII/4096:1-4          39773         12181         -69.37%
    BenchmarkTrimASCII/4096:2-4          39946         17231         -56.86%
    BenchmarkTrimASCII/4096:4-4          39641         17179         -56.66%
    BenchmarkTrimASCII/4096:8-4          39835         17175         -56.88%
    BenchmarkTrimASCII/4096:16-4         40229         17215         -57.21%
    
    == strings package ==
    benchmark                            old ns/op     new ns/op     delta
    BenchmarkIndexAnyASCII/1:1-4         5.94          4.97          -16.33%
    BenchmarkIndexAnyASCII/1:2-4         5.94          5.55          -6.57%
    BenchmarkIndexAnyASCII/1:4-4         7.45          7.21          -3.22%
    BenchmarkIndexAnyASCII/1:8-4         10.8          10.6          -1.85%
    BenchmarkIndexAnyASCII/1:16-4        17.4          17.2          -1.15%
    BenchmarkIndexAnyASCII/16:1-4        36.4          32.2          -11.54%
    BenchmarkIndexAnyASCII/16:2-4        49.6          34.6          -30.24%
    BenchmarkIndexAnyASCII/16:4-4        77.5          37.9          -51.10%
    BenchmarkIndexAnyASCII/16:8-4        138           45.5          -67.03%
    BenchmarkIndexAnyASCII/16:16-4       241           59.1          -75.48%
    BenchmarkIndexAnyASCII/256:1-4       509           378           -25.74%
    BenchmarkIndexAnyASCII/256:2-4       720           381           -47.08%
    BenchmarkIndexAnyASCII/256:4-4       1142          384           -66.37%
    BenchmarkIndexAnyASCII/256:8-4       1999          391           -80.44%
    BenchmarkIndexAnyASCII/256:16-4      3735          403           -89.21%
    BenchmarkIndexAnyASCII/4096:1-4      7973          5824          -26.95%
    BenchmarkIndexAnyASCII/4096:2-4      11432         5809          -49.19%
    BenchmarkIndexAnyASCII/4096:4-4      18327         5819          -68.25%
    BenchmarkIndexAnyASCII/4096:8-4      33059         5828          -82.37%
    BenchmarkIndexAnyASCII/4096:16-4     59703         5817          -90.26%
    BenchmarkTrimASCII/1:1-4             71.9          71.8          -0.14%
    BenchmarkTrimASCII/1:2-4             73.3          103           +40.52%
    BenchmarkTrimASCII/1:4-4             71.8          106           +47.63%
    BenchmarkTrimASCII/1:8-4             71.2          113           +58.71%
    BenchmarkTrimASCII/1:16-4            71.6          128           +78.77%
    BenchmarkTrimASCII/16:1-4            152           116           -23.68%
    BenchmarkTrimASCII/16:2-4            160           168           +5.00%
    BenchmarkTrimASCII/16:4-4            172           170           -1.16%
    BenchmarkTrimASCII/16:8-4            200           177           -11.50%
    BenchmarkTrimASCII/16:16-4           254           193           -24.02%
    BenchmarkTrimASCII/256:1-4           1438          864           -39.92%
    BenchmarkTrimASCII/256:2-4           1551          1195          -22.95%
    BenchmarkTrimASCII/256:4-4           1770          1200          -32.20%
    BenchmarkTrimASCII/256:8-4           2195          1216          -44.60%
    BenchmarkTrimASCII/256:16-4          3054          1224          -59.92%
    BenchmarkTrimASCII/4096:1-4          21726         12557         -42.20%
    BenchmarkTrimASCII/4096:2-4          23586         17508         -25.77%
    BenchmarkTrimASCII/4096:4-4          26898         17510         -34.90%
    BenchmarkTrimASCII/4096:8-4          33714         17595         -47.81%
    BenchmarkTrimASCII/4096:16-4         47429         17700         -62.68%
    
    The benchmarks added test the worst case. For IndexAny, that is when the
    charset matches none of the input. For Trim, it is when the charset matches
    all of the input.
    
    Change-Id: I970874d101a96b33528fc99b165379abe58cf6ea
    Reviewed-on: https://go-review.googlesource.com/31593
    Run-TryBot: Joe Tsai <thebrokentoaster@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Martin Möhrmann <martisch@uos.de>

commit ef3a9f2dd410ec1672988a72c72919eab2d58e6c
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 13:12:17 2016 -0400

    html/template, text/template: drop defined template list from errors
    
    The report in #17414 points out that if you have many many templates,
    then this is an overwhelming list and just hurts the signal-to-noise ratio of the error.
    
    Even the test of the old behavior also supports the idea that this is noise:
    
            template: empty: "empty" is an incomplete or empty template; defined templates are: "secondary"
    
    The chance that someone mistyped "secondary" as "empty" is slim at best.
    
    Similarly, the compiler does not augment an error like 'unknown variable x'
    by dumping the full list of all the known variables.
    
    For all these reasons, drop the list.
    
    Fixes #17414.
    
    Change-Id: I78f92d2c591df7218385fe723a4abc497913acf8
    Reviewed-on: https://go-review.googlesource.com/32116
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>

commit 54f691d69d39bc19c2069384cd702c6fdec0b92d
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 23:18:53 2016 -0400

    runtime: skip TestMemmoveOverflow if mmap of needed page fails
    
    Fixes #16731.
    
    Change-Id: I6d393357973d008ab7cf5fb264acb7d38c9354eb
    Reviewed-on: https://go-review.googlesource.com/32104
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 7fd6b925e38f67c2d0cb3fca0f3dc8b6dfb0708c
Author: Robert Griesemer <gri@golang.org>
Date:   Fri Oct 28 09:54:20 2016 -0700

    spec: update operator and delimiter section
    
    Follow-up on https://go-review.googlesource.com/30601.
    
    Change-Id: I51b603a6c4877b571e83cd7c4e78a8988cc831ca
    Reviewed-on: https://go-review.googlesource.com/32310
    Reviewed-by: Rob Pike <r@golang.org>

commit d86a6ef0c7e8307802c6cd3f623bade3e78a42bf
Author: Josh Chorlton <jchorlton@gmail.com>
Date:   Thu Oct 27 23:10:26 2016 +0800

    net/http: fix cookie Expires minimum year to 1601 instead of Epoch year 1970
    
    Following RFC 6265 Section 5.1.1.5, ensure that the minimum
    year for which an Expires value is valid and can be included in
    the cookie's string, is 1601 instead of the Epoch year 1970.
    
    A detailed specification for parsing the Expiry field is at:
    https://tools.ietf.org/html/rfc6265#section-5.2.1
    
    I stumbled across this bug due to this StackOverflow answer
    that recommends setting the Expiry to the Epoch:
    http://stackoverflow.com/a/5285982
    
    Fixes #17632
    
    Change-Id: I3c1bdf821d369320334a5dc1e4bf22783cbfe9fc
    Reviewed-on: https://go-review.googlesource.com/32142
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit a8e86d99f18a72c8cbdedf5a47a9f7e93a87cd04
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 13:34:55 2016 -0400

    mime/quotedprintable: accept = not followed by 2 hex digits as literal equals
    
    This lets quotedprintable handle some inputs found in the wild,
    most notably generated by "Microsoft CDO for Exchange 2000",
    and it also matches how Python's quopri package handles these inputs.
    
    Fixes #13219.
    
    Change-Id: I69d400659d01b6ea0f707b7053d61803a85b4799
    Reviewed-on: https://go-review.googlesource.com/32174
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Robert Griesemer <gri@golang.org>

commit 864859d209a144eb1a703381ec96b9c897d4e493
Author: Jaana Burcu Dogan <jbd@google.com>
Date:   Wed Oct 26 11:46:06 2016 -0700

    net/http/httptrace: refer http.Client users to the blog post
    
    Fixes #17152.
    
    Change-Id: I4dd5e505c65f3efe736e46d3781cccf31d7f574f
    Reviewed-on: https://go-review.googlesource.com/32117
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit fc2507dbd3b1c1df97a9673a2ed5243f05a3449a
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Fri Oct 28 03:56:30 2016 +0000

    doc: remove mention of Go 1.6.3 working on Sierra
    
    We thought it would at the time, but then Beta 4 changed the ABI
    again, so it wasn't true in practice.
    
    Fixes #17643
    
    Change-Id: I36b747bd69a56adc7291fa30d6bffdf67ab8741b
    Reviewed-on: https://go-review.googlesource.com/32238
    Reviewed-by: Russ Cox <rsc@golang.org>

commit 6da83c6fc006019f6fe0503099d165e19f465b1b
Author: Austin Clements <austin@google.com>
Date:   Sat Oct 8 18:38:35 2016 -0400

    runtime, cmd/trace: track goroutines blocked on GC assists
    
    Currently when a goroutine blocks on a GC assist, it emits a generic
    EvGoBlock event. Since assist blocking events and, in particular, the
    length of the blocked assist queue, are important for diagnosing GC
    behavior, this commit adds a new EvGoBlockGC event for blocking on a
    GC assist. The trace viewer uses this event to report a "waiting on
    GC" count in the "Goroutines" row. This makes sense because, unlike
    other blocked goroutines, these goroutines do have work to do, so
    being blocked on a GC assist is quite similar to being in the
    "runnable" state, which we also report in the trace viewer.
    
    Change-Id: Ic21a326992606b121ea3d3d00110d8d1fdc7a5ef
    Reviewed-on: https://go-review.googlesource.com/30704
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

commit 640e9169155ea96a6f1156663269dba5babf0632
Author: Austin Clements <austin@google.com>
Date:   Sat Oct 8 17:35:27 2016 -0400

    cmd/trace: track each G's state explicitly
    
    Currently the trace tool tracks an overall counts of goroutine states,
    but not the states of any individual goroutine. We're about to add
    more sophisticated blocked-state tracking, so add this tracking and
    base the state counts off the tracked goroutine states.
    
    Change-Id: I943ed61782436cf9540f4ee26c5561715c5b4a1d
    Reviewed-on: https://go-review.googlesource.com/30703
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

commit 68348394274ee83f5286022d97cfe58b6761321b
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 7 17:25:26 2016 -0400

    runtime, cmd/trace: annotate different mark worker types
    
    Currently mark workers are shown in the trace as regular goroutines
    labeled "runtime.gcBgMarkWorker". That's somewhat unhelpful to an end
    user because of the opaque label and particularly unhelpful to runtime
    developers because it doesn't distinguish the different types of mark
    workers.
    
    Fix this by introducing a variant of the GoStart event called
    GoStartLabel that lets the runtime indicate a label for a goroutine
    execution span and using this to label mark worker executions as "GC
    (<mode>)" in the trace viewer.
    
    Since this bumps the trace version to 1.8, we also add test data for
    1.7 traces.
    
    Change-Id: Id7b9c0536508430c661ffb9e40e436f3901ca121
    Reviewed-on: https://go-review.googlesource.com/30702
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

commit f9238a76ff0082071527ce8ec94542a297f594f8
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Oct 26 15:44:19 2016 -0400

    cmd/compile: make LR allocatable in non-leaf functions on ARM
    
    The mechanism is initially introduced (and reviewed) in CL 30597
    on S390X.
    
    Reduce number of "spilled value remains" by 0.4% in cmd/go.
    
    Disabled on ARMv5 because LR is clobbered almost everywhere with
    inserted softfloat calls.
    
    Change-Id: I2934737ce2455909647ed2118fe2bd6f0aa5ac52
    Reviewed-on: https://go-review.googlesource.com/32178
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit 4f1ca8b6f92d69a889a6884d3b8393fdcf530e2b
Author: Cherry Zhang <cherryyz@google.com>
Date:   Thu Oct 27 17:52:53 2016 -0400

    cmd/internal/obj/mips: materialize float constant 0 from zero register
    
    Materialize float constant 0 from integer zero register, instead
    of loading from constant pool.
    
    Change-Id: Ie4728895b9d617bec2a29d15729c0efaa10eedbb
    Reviewed-on: https://go-review.googlesource.com/32109
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit 0acefdbea07252191aa24b8bbbddeecbfa3e7ed9
Author: Carlos Eduardo Seo <cseo@linux.vnet.ibm.com>
Date:   Thu Jul 21 18:09:48 2016 -0300

    cmd/asm, cmd/internal/obj/ppc64: Add vector scalar (VSX) registers and instructions
    
    The current implementation for Power architecture does not include the vector
    scalar (VSX) registers.  This adds the 63 VSX registers and the most commonly
    used instructions: load/store VSX vector/scalar, move to/from VSR, logical
    operations, select, merge, splat, permute, shift, FP-FP conversion, FP-integer
    conversion and integer-FP conversion.
    
    Change-Id: I0f7572d2359fe7f3ea0124a1eb1b0bebab33649e
    Reviewed-on: https://go-review.googlesource.com/30510
    Reviewed-by: Lynn Boger <laboger@linux.vnet.ibm.com>
    Reviewed-by: David Chase <drchase@google.com>
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 9c02c75639b893cea6dbce1092d07e886ec5f44e
Author: David Crawshaw <crawshaw@golang.org>
Date:   Wed Oct 26 13:29:39 2016 -0400

    runtime: pass windows float syscall args via XMM
    
    Based on the calling convention documented in:
    
            https://msdn.microsoft.com/en-us/library/zthk2dkh.aspx
    
    and long-used in golang.org/x/mobile/gl via some fixup asm:
    
            https://go.googlesource.com/mobile/+/master/gl/work_windows_amd64.s
    
    Fixes #6510
    
    Change-Id: I97e81baaa2872bcd732b1308915eb66f1ba2168f
    Reviewed-on: https://go-review.googlesource.com/32173
    Run-TryBot: David Crawshaw <crawshaw@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
    Reviewed-by: Minux Ma <minux@golang.org>

commit dd500193d3e96e6bc9700fd43fc68b55e662d7c1
Author: Austin Clements <austin@google.com>
Date:   Thu Oct 27 21:52:51 2016 -0400

    runtime: fix preemption of fractional and idle mark workers
    
    Currently, gcDrain looks for the preemption flag at getg().preempt.
    However, commit d6625ca moved mark worker draining to the system
    stack, which means getg() returns the g0, which never has the preempt
    flag set, so idle and fractional workers don't get preempted after
    10ms and just run until they run out of work. As a result, if there's
    enough idle time, GC becomes effectively STW.
    
    Fix this by looking for the preemption flag on getg().m.curg, which
    will always be the user G (where the preempt flag is set), regardless
    of whether gcDrain is running on the user or the g0 stack.
    
    Change-Id: Ib554cf49a705b86ccc3d08940bc869f868c50dd2
    Reviewed-on: https://go-review.googlesource.com/32251
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit ca922b6d363b6ca47822188dcbc5b92d912c7a4b
Author: Peter Weinberger <pjw@google.com>
Date:   Thu Sep 22 09:48:30 2016 -0400

    runtime: Profile goroutines holding contended mutexes.
    
    runtime.SetMutexProfileFraction(n int) will capture 1/n-th of stack
    traces of goroutines holding contended mutexes if n > 0. From runtime/pprof,
    pprot.Lookup("mutex").WriteTo writes the accumulated
    stack traces to w (in essentially the same format that blocking
    profiling uses).
    
    Change-Id: Ie0b54fa4226853d99aa42c14cb529ae586a8335a
    Reviewed-on: https://go-review.googlesource.com/29650
    Reviewed-by: Austin Clements <austin@google.com>

commit b679665a182bd6ec2989ae759df6b11142921cfb
Author: Martin Möhrmann <martisch@uos.de>
Date:   Thu Oct 27 23:31:38 2016 +0200

    cmd/compile: move stringtoslicebytetmp to the backend
    
    - removes the runtime function stringtoslicebytetmp
    - removes the generation of calls to stringtoslicebytetmp from the frontend
    - adds handling of OSTRARRAYBYTETMP in the backend
    
    This reduces binary sizes and avoids function call overhead.
    
    Change-Id: Ib9988d48549cee663b685b4897a483f94727b940
    Reviewed-on: https://go-review.googlesource.com/32158
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>
    Run-TryBot: Martin Möhrmann <martisch@uos.de>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit f595848e9a1e1d0f64a7018d847167d85f6e83a4
Author: Alex Brainman <alex.brainman@gmail.com>
Date:   Fri Oct 28 11:51:22 2016 +1100

    runtime/cgo: do not link threads lib by default on windows
    
    I do not know why it is included. All tests pass without it.
    
    Change-Id: I839076ee131816dfd177570a902c69fe8fba5022
    Reviewed-on: https://go-review.googlesource.com/32144
    Run-TryBot: Minux Ma <minux@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 79d2115ec933904c02311cd31923b125fe4303dc
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Thu Oct 27 19:53:50 2016 -0700

    cmd/compile: eliminate more allocs in newblock
    
    name       old allocs/op    new allocs/op    delta
    Template         389k ± 0%        386k ± 0%  -0.84%        (p=0.000 n=10+10)
    Unicode          323k ± 0%        323k ± 0%  -0.25%        (p=0.000 n=10+10)
    GoTypes         1.17M ± 0%       1.16M ± 0%  -0.93%        (p=0.000 n=10+10)
    Compiler        4.13M ± 0%       4.09M ± 0%  -1.05%        (p=0.000 n=10+10)
    
    Change-Id: I6c00850d07511c2e65761c7373fc3df738499105
    Reviewed-on: https://go-review.googlesource.com/32235
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    Reviewed-by: David Crawshaw <crawshaw@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 23d762c1298f6e3f0507debc9bfba83c66a8796e
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Wed Oct 26 23:40:14 2016 -0700

    cmd/compile: combine slice allocations in newblock
    
    name       old allocs/op    new allocs/op    delta
    Template         394k ± 0%        391k ± 0%  -0.80%        (p=0.000 n=10+10)
    Unicode          350k ± 0%        349k ± 0%  -0.27%        (p=0.000 n=10+10)
    GoTypes         1.18M ± 0%       1.17M ± 0%  -0.92%        (p=0.000 n=10+10)
    Compiler        4.18M ± 0%       4.14M ± 0%  -1.05%        (p=0.000 n=10+10)
    
    
    Change-Id: I838a4e2110afe6496c535b9a0ec5aa882d63a707
    Reviewed-on: https://go-review.googlesource.com/32223
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit caba0bd18912109f4d9fa2f4807d6ee4ddd5ffab
Author: Nigel Tao <nigeltao@golang.org>
Date:   Fri Oct 28 10:26:44 2016 +1100

    image/png: implement grayscale transparency.
    
    Change-Id: Ib9309ee499fc51be2662d778430ee30089822e57
    Reviewed-on: https://go-review.googlesource.com/32143
    Reviewed-by: Rob Pike <r@golang.org>

commit bba1ac4fd9d208892aa45e49eda215954008d2ee
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Thu Oct 27 02:02:30 2016 -0700

    cmd/compile: stop adding implicit OKEY nodes
    
    Keys are uncommon in array and slice literals, and normalizing
    OARRAYLIT and OSLICELIT nodes to always use OKEY ends up not reducing
    complexity much. Instead, only create OKEY nodes to represent explicit
    keys, and recalculate implicit keys when/where necessary.
    
    Fixes #15350.
    
    name       old time/op     new time/op     delta
    Template       299ms ± 9%      299ms ±12%    ~           (p=0.694 n=28+30)
    Unicode        165ms ± 7%      162ms ± 9%    ~           (p=0.084 n=27+27)
    GoTypes        950ms ± 9%      963ms ± 5%    ~           (p=0.301 n=30+29)
    Compiler       4.23s ± 7%      4.17s ± 7%    ~           (p=0.057 n=29+27)
    
    name       old user-ns/op  new user-ns/op  delta
    Template        389M ±15%       400M ±12%    ~           (p=0.202 n=30+29)
    Unicode         246M ±21%       232M ±22%  -5.76%        (p=0.006 n=28+29)
    GoTypes        1.34G ± 8%      1.34G ± 7%    ~           (p=0.775 n=28+30)
    Compiler       5.91G ± 6%      5.87G ± 7%    ~           (p=0.298 n=28+29)
    
    name       old alloc/op    new alloc/op    delta
    Template      41.2MB ± 0%     41.2MB ± 0%    ~           (p=0.085 n=30+30)
    Unicode       34.0MB ± 0%     31.5MB ± 0%  -7.28%        (p=0.000 n=30+29)
    GoTypes        121MB ± 0%      121MB ± 0%    ~           (p=0.657 n=30+30)
    Compiler       511MB ± 0%      511MB ± 0%  -0.01%        (p=0.001 n=29+29)
    
    name       old allocs/op   new allocs/op   delta
    Template        390k ± 0%       390k ± 0%    ~           (p=0.225 n=30+29)
    Unicode         318k ± 0%       293k ± 0%  -8.03%        (p=0.000 n=30+29)
    GoTypes        1.16M ± 0%      1.16M ± 0%    ~           (p=0.745 n=30+30)
    Compiler       4.35M ± 0%      4.35M ± 0%    ~           (p=0.105 n=30+30)
    
    Change-Id: I6310739a0bfdb54f1ab8a460b2c03615ad1ff5bc
    Reviewed-on: https://go-review.googlesource.com/32221
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 4951c793633a55c5d1e4d94283fa82cff31cee48
Author: Nigel Tao <nigeltao@golang.org>
Date:   Thu Oct 27 16:19:15 2016 +1100

    image/png: implement truecolor transparency.
    
    Change-Id: I99b9a51db29d514ebaa9c1cfde65c0b5184c0f42
    Reviewed-on: https://go-review.googlesource.com/32140
    Reviewed-by: Rob Pike <r@golang.org>

commit 0dabbcdc435e4babf76bd561cfe67a486404d73a
Author: Cherry Zhang <cherryyz@google.com>
Date:   Thu Oct 27 16:42:42 2016 -0400

    math/big: flip long/short flag on TestFloat32Distribution
    
    It looks like a typo in CL 30707.
    
    Change-Id: Ia2d013567dbd1a49901d9be0cd2d5a103e6e38cf
    Reviewed-on: https://go-review.googlesource.com/32187
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

commit f357091a6d48c3a87db14338b321eca52af30dd7
Author: Keith Randall <khr@golang.org>
Date:   Tue Aug 30 14:59:34 2016 -0700

    cmd/compile: combine some extensions with loads
    
    For cases where we already have the ops, combine
    sign or zero extension with the previous load
    (even if the load is larger width).
    
    Update #15105
    
    Change-Id: I76c5ddd69e1f900d2a17d35503083bd3b4978e48
    Reviewed-on: https://go-review.googlesource.com/28190
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit dc5f9311be7d75a283d124aa52e04ac5b2005e46
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Wed Oct 26 22:58:50 2016 -0700

    cmd/compile: eliminate Name.Inlvar
    
    Use a local map during inlining instead.
    
    Change-Id: I10cd19885e7124f812bb04a79dbda52bfebfe1a1
    Reviewed-on: https://go-review.googlesource.com/32225
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit ac74225dcc64d40839f3842d306442d33a5c6253
Author: Keith Randall <khr@golang.org>
Date:   Tue Aug 30 15:25:20 2016 -0700

    cmd/compile: remove redundant extension after shift
    
    var x uint64
    uint8(x >> 56)
    
    We don't need to generate any code for the uint8().
    
    Update #15090
    
    Change-Id: Ie1ca4e32022dccf7f7bc42d531a285521fb67872
    Reviewed-on: https://go-review.googlesource.com/28191
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit deb4177cf0b8352f4908c0eba9e81dfb0213545c
Author: Keith Randall <khr@golang.org>
Date:   Tue Oct 25 15:49:52 2016 -0700

    cmd/compile: use masks instead of branches for slicing
    
    When we do
    
      var x []byte = ...
      y := x[i:]
    
    We can't just use y.ptr = x.ptr + i, as the new pointer may point to the
    next object in memory after the backing array.
    We used to fix this by doing:
    
      y.cap = x.cap - i
      delta := i
      if y.cap == 0 {
        delta = 0
      }
      y.ptr = x.ptr + delta
    
    That generates a branch in what is otherwise straight-line code.
    
    Better to do:
    
      y.cap = x.cap - i
      mask := (y.cap - 1) >> 63 // -1 if y.cap==0, 0 otherwise
      y.ptr = x.ptr + i &^ mask
    
    It's about the same number of instructions (~4, depending on what
    parts are constant, and the target architecture), but it is all
    inline. It plays nicely with CSE, and the mask can be computed
    in parallel with the index (in cases where a multiply is required).
    
    It is a minor win in both speed and space.
    
    Change-Id: Ied60465a0b8abb683c02208402e5bb7ac0e8370f
    Reviewed-on: https://go-review.googlesource.com/32022
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 50f66fbb66c2f3cdfc9f942c5e11cc1b9ec17a73
Author: Robert Griesemer <gri@golang.org>
Date:   Thu Oct 27 12:53:25 2016 -0700

    cmd/compile: disallow "init" as alias
    
    Fixes #17637.
    
    Change-Id: I5af63b8277c0a0f9fef4880992bcb925ca088687
    Reviewed-on: https://go-review.googlesource.com/32106
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 89632aa1832a02e36acd458b3b35257d8133ae0c
Author: Robert Griesemer <gri@golang.org>
Date:   Thu Oct 27 11:20:20 2016 -0700

    cmd/compile, go/parser: disallow "type T = p.T" - must use "=>"
    
    I had added this originally so we can play with different notations
    but it doesn't make sense to keep it around since gofmt will convert
    a type alias declaration using "=" into one using "=>" anyhow. More
    importantly, the spec doesn't permit it.
    
    Change-Id: Icb010b5a9976aebf877e48b3ce9d7245559ca494
    Reviewed-on: https://go-review.googlesource.com/32105
    Run-TryBot: Robert Griesemer <gri@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 8b07ec20f7a971edce9eaf413b20e453c50858c6
Author: Michael Hudson-Doyle <michael.hudson@canonical.com>
Date:   Wed Oct 26 15:57:58 2016 +1300

    cmd/compile, runtime: make the go.itab.* symbols module-local
    
    Otherwise, the way the ELF dynamic linker works means that you can end up with
    the same itab being passed to additab twice, leading to the itab linked list
    having a cycle in it. Add a test to additab in runtime to catch this when it
    happens, not some arbitrary and surprsing time later.
    
    Fixes #17594
    
    Change-Id: I6c82edcc9ac88ac188d1185370242dc92f46b1ad
    Reviewed-on: https://go-review.googlesource.com/32131
    Run-TryBot: Michael Hudson-Doyle <michael.hudson@canonical.com>
    Reviewed-by: David Crawshaw <crawshaw@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit aabdb66d8909f772270b80eff3405cfd4cce4d8b
Author: Adam Langley <agl@golang.org>
Date:   Thu Oct 27 10:28:31 2016 -0700

    vendor/golang_org/x/crypto/poly1305: sync to 1150b8bd09e53aea1d415621adae9bad665061a1
    
    This change updates the vendored version of the poly1305 package to
    match the latest version from x/crypto. This pulls in this change:
    
      commit 1150b8bd09e53aea1d415621adae9bad665061a1
      Author: Adam Langley <agl@golang.org>
      Date:   Fri Oct 21 15:59:10 2016 -0700
    
          poly1305: don't move R13 in sum_arm.s.
    
          Rather than change the value of R13 during the execution, keep R13 fixed
          (after the initial prelude) and always use offsets from it.
    
          This should help the runtime figure out what's going on if, say, a
          signal should occur while running this code.
    
          I've also trimmed the set of saved registers since Go doesn't require
          the callee to maintain anything except R10 and R13.
    
          Change-Id: Ifbeca73c1d964cc43bb7f8c20c61066f22fd562d
          Reviewed-on: https://go-review.googlesource.com/31717
          Run-TryBot: Cherry Zhang <cherryyz@google.com>
          TryBot-Result: Gobot Gobot <gobot@golang.org>
          Reviewed-by: Cherry Zhang <cherryyz@google.com>
    
    Change-Id: I376b3e5d53aaded891e02801bd5faa5ff758da0d
    Reviewed-on: https://go-review.googlesource.com/32227
    Run-TryBot: Adam Langley <agl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit c01c1d4215ea8b19014017673a5adc8b1a9cad0a
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 20:05:20 2016 -0400

    net: add examples to Addr definition
    
    Fixes #16014.
    
    Change-Id: I68b096df7924a3258e940c4d94ec5d06f5bdfcbb
    Reviewed-on: https://go-review.googlesource.com/32097
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit eac59508199f77f55d986ab1a7439c7488a20650
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 14:32:43 2016 -0400

    mime: preserve unnecessary backslash escapes as literals
    
    When MSIE sends a full file path (in "intranet mode"), it does not
    escape backslashes: "C:\dev\go\foo.txt", not "C:\\dev\\go\\foo.txt".
    
    No known MIME generators emit unnecessary backslash escapes
    for simple token characters like numbers and letters.
    
    If we see an unnecessary backslash escape, assume it is from MSIE
    and intended as a literal backslash. This makes Go servers deal better
    with MSIE without affecting the way they handle conforming MIME
    generators.
    
    Fixes #15664.
    
    Change-Id: Ia3b03b978317d968dc11b2f6de1df913c6bcbfcc
    Reviewed-on: https://go-review.googlesource.com/32175
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 2bafbe11b1389c3a589314b74ab24f936816befb
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 16:48:53 2016 -0400

    net/mail: allow empty quoted string name in address again
    
    CL 12905 disallowed "Bob" <""@example.com> but inadvertently
    also disallowed "" <bob@example.com>. Move the empty string
    check to apply only in the addr-spec.
    
    Fixes #14866.
    
    Change-Id: Ia0b7a1a32810aa78157ae77bd0130b78154c460d
    Reviewed-on: https://go-review.googlesource.com/32176
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 07e72666ec6da774860c6f796c3adbdc57c92480
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Thu Oct 27 00:29:43 2016 +0000

    net/http: update bundled http2
    
    Updates http2 to x/net git rev b626cca for:
    
        http2: implement support for server push
        https://golang.org/cl/29439
    
        http2: reject stream self-dependencies
        https://golang.org/cl/31858
    
        http2: optimize server frame writes
        https://golang.org/cl/31495
    
        http2: interface to support pluggable schedulers
        https://golang.org/cl/25366
        (no user-visible behavior change or API surface)
    
        http2: add Server.IdleTimeout
        https://golang.org/cl/31727
    
        http2: make Server return conn protocol errors on bad idle stream frames
        https://golang.org/cl/31736
    
        http2: fix optimized write scheduling
        https://golang.org/cl/32217 (fix for CL 31495 above)
    
    Change-Id: Ie894c72943d355115c8391573bf6b96dc1bd5894
    Reviewed-on: https://go-review.googlesource.com/32215
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Tom Bergan <tombergan@google.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 5594074dcd09d0bb8c35998e20cddf728893ff00
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 27 09:22:43 2016 -0400

    runtime: use clock_gettime(CLOCK_REALTIME) for nanosecond-precision time.now on arm64, mips64x
    
    Assembly copied from the clock_gettime(CLOCK_MONOTONIC)
    call in runtime.nanotime in these files and then modified to use
    CLOCK_REALTIME.
    
    Also comment system call numbers in a few other files.
    
    Fixes #11222.
    
    Change-Id: Ie132086de7386f865908183aac2713f90fc73e0d
    Reviewed-on: https://go-review.googlesource.com/32177
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit aff37662d1f70f2bf9e47b4f962e85521e7c18d1
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Oct 4 10:06:14 2016 -0700

    spec: add new language for alias declarations
    
    For #16339.
    
    Change-Id: I7d912ea634bbfacfc0217f97dccb270fde06f16b
    Reviewed-on: https://go-review.googlesource.com/30601
    Reviewed-by: Russ Cox <rsc@golang.org>

commit 09692182fa79fcaf89aa08ccf74ad74562ccba04
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 27 12:43:37 2016 -0400

    runtime: print sigcode on signal crash
    
    For #17496.
    
    Change-Id: I671a59581c54d17bc272767eeb7b2742b54eca38
    Reviewed-on: https://go-review.googlesource.com/32183
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 03d81b5ed91dfb3a2d1041bfe80dd94e7f06a3c4
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Oct 25 14:09:18 2016 -0700

    cmd/compile: import/export of alias declarations
    
    This CL completes support for alias declarations in the compiler.
    
    Also:
    - increased export format version
    - updated various comments
    
    For #16339.
    Fixes #17487.
    
    Change-Id: Ic6945fc44c0041771eaf9dcfe973f601d14de069
    Reviewed-on: https://go-review.googlesource.com/32090
    Run-TryBot: Robert Griesemer <gri@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 81038d2e2b588f9df45d20a2ca0be446b0e421b2
Author: Adam Langley <agl@golang.org>
Date:   Wed Oct 26 10:05:03 2016 -0700

    crypto/tls: add GetClientCertificate callback
    
    Currently, the selection of a client certificate done internally based
    on the limitations given by the server's request and the certifcates in
    the Config. This means that it's not possible for an application to
    control that selection based on details of the request.
    
    This change adds a callback, GetClientCertificate, that is called by a
    Client during the handshake and which allows applications to select the
    best certificate at that time.
    
    (Based on https://golang.org/cl/25570/ by Bernd Fix.)
    
    Fixes #16626.
    
    Change-Id: Ia4cea03235d2aa3c9fd49c99c227593c8e86ddd9
    Reviewed-on: https://go-review.googlesource.com/32115
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 6c242c52d355772f66466505dd7555d4601f1c5a
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 26 16:58:00 2016 -0400

    net/rpc: fix method requirement docs
    
    The receiver itself is not transmitted and does not need to be
    marshalable by encoding/gob.
    
    Fixes #16803.
    
    Change-Id: I42a3603fb7d3b36c97dcc2e51a398cd65ec3227d
    Reviewed-on: https://go-review.googlesource.com/32094
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>

commit ec18e93ecd550b10bc36b88d625533a7b7473313
Author: Adam Langley <agl@golang.org>
Date:   Wed Oct 26 12:30:30 2016 -0700

    crypto/tls: add a SignatureScheme type.
    
    The SignatureAndHashAlgorithm from TLS 1.2[1] is being changed to
    SignatureScheme in TLS 1.3[2]. (The actual values are compatible
    however.)
    
    Since we expect to support TLS 1.3 in the future, we're already using
    the name and style of SignatureScheme in the recently augmented
    ClientHelloInfo. As this is public API, it seems that SignatureScheme
    should have its own type and exported values, which is implemented in
    this change.
    
    [1] https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1
    [2] https://tools.ietf.org/html/draft-ietf-tls-tls13-18#section-4.2.3
    
    Change-Id: I0482755d02bb9a04eaf075c012696103eb806645
    Reviewed-on: https://go-review.googlesource.com/32119
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Adam Langley <agl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 07a31bc3da1115775c6607fa400e2d147f6c17c3
Author: Adam Langley <agl@golang.org>
Date:   Wed Oct 26 13:57:08 2016 -0700

    crypto/x509: don't accept a root that already appears in a chain.
    
    Since a root certificate is self-signed, it's a valid child of itself.
    If a root certificate appeared both in the pool of intermediates and
    roots the verification code could find a chain which included it twice:
    first as an intermediate and then as a root. (Existing checks prevented
    the code from looping any more.)
    
    This change stops the exact same certificate from appearing twice in a
    chain. This simplifies the results in the face of the common
    configuration error of a TLS server returning a root certificate.
    
    (This should also stop two different versions of the “same” root
    appearing in a chain because the self-signature on one will not validate
    for the other.)
    
    Fixes #16800.
    
    Change-Id: I004853baa0eea27b44d47b9b34f96113a92ebac8
    Reviewed-on: https://go-review.googlesource.com/32121
    Run-TryBot: Adam Langley <agl@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit a047b6bf7d90cc7185f18af3c179dfc7e66b66e9
Author: Keith Randall <khr@golang.org>
Date:   Thu Oct 27 09:23:48 2016 -0700

    cmd/compile: emit assignments after calls in the right order
    
    Fixes a bug where assignments that should come after a call
    were instead being issued before the call.
    
    Fixes #17596
    Fixes #17618
    
    Change-Id: Ic9ae4c34ae38fc4ccd0604b65345b05896a2c295
    Reviewed-on: https://go-review.googlesource.com/32226
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>

commit dc53ea77721e1d5c372c04ba3f20d45e5aec7103
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Wed Oct 26 22:23:32 2016 -0700

    cmd/compile: change Func.FCurfn to IsHiddenClosure
    
    IsHiddenClosure is more descriptive.
    
    Change-Id: I06651072925a958b148b64ab0db3a9bfc839af9b
    Reviewed-on: https://go-review.googlesource.com/32224
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 4f6d479186f8a0303159f04c3673f6ea80b45a03
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Oct 26 15:58:51 2016 -0400

    cmd/compile: make LR allocatable in non-leaf functions on MIPS64
    
    The mechanism is initially introduced (and reviewed) in CL 30597
    on S390X.
    
    Change-Id: I83024d2fc84c8efc23fbda52b3ad83073f42cb93
    Reviewed-on: https://go-review.googlesource.com/32179
    Reviewed-by: David Chase <drchase@google.com>

commit 5c59cb4aa308828884079b13f100b539448a0861
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Oct 26 16:06:16 2016 -0400

    cmd/compile: make LR allocatable in non-leaf functions on ARM64
    
    The mechanism is initially introduced (and reviewed) in CL 30597
    on S390X.
    
    Change-Id: I12fbe6e9269b2936690e0ec896cb6b5aa40ad7da
    Reviewed-on: https://go-review.googlesource.com/32180
    Reviewed-by: David Chase <drchase@google.com>

commit c69dd3f0547e5846ce259a02d0b6ad9f19b566b6
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Oct 26 16:17:54 2016 -0400

    cmd/compile: enable DUFFZERO in defframe on MIPS64
    
    DUFFZERO was disabled due to issue #12108. CL 27592 fixed it and
    enabled DUFFZERO in general, but this one was forgotten.
    
    Change-Id: I0476a3a0524c7b54218f7a747bdba76cd823fbc5
    Reviewed-on: https://go-review.googlesource.com/32181
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: David Chase <drchase@google.com>

commit 4c182045ff6af5657d5ef0f43ba1fd11a4d06be5
Author: Vladimir Stefanovic <vladimir.stefanovic@imgtec.com>
Date:   Tue Oct 18 23:51:19 2016 +0200

    cmd/objdump: skip tests for GOARCH=mips{,le}
    
    Change-Id: I8111ceb6960364166aa8a445f4d6d8b0581d371e
    Reviewed-on: https://go-review.googlesource.com/31513
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 0d176621d925915152b7b0b332e553b6f0d635e2
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Wed Oct 26 22:05:20 2016 -0700

    cmd/compile: reuse sort helpers
    
    sort.Sort's argument always escapes.
    cse generates many calls to sort.Sort.
    Set up a single escaping variable
    and re-use it across loops.
    
    name       old alloc/op     new alloc/op     delta
    Template       40.7MB ± 0%      40.2MB ± 0%  -1.24%        (p=0.000 n=15+15)
    Unicode        33.4MB ± 0%      33.3MB ± 0%  -0.09%        (p=0.000 n=15+15)
    GoTypes         121MB ± 0%       119MB ± 0%  -1.48%        (p=0.000 n=14+15)
    Compiler        474MB ± 0%       465MB ± 0%  -1.94%        (p=0.000 n=14+15)
    
    name       old allocs/op    new allocs/op    delta
    Template         405k ± 0%        394k ± 0%  -2.64%        (p=0.000 n=15+15)
    Unicode          350k ± 0%        350k ± 0%  -0.14%        (p=0.000 n=14+15)
    GoTypes         1.21M ± 0%       1.18M ± 0%  -3.07%        (p=0.000 n=15+14)
    Compiler        4.37M ± 0%       4.18M ± 0%  -4.39%        (p=0.000 n=15+15)
    
    
    Change-Id: I68cf56dafa0f3ea778826eea19908bd761556154
    Reviewed-on: https://go-review.googlesource.com/32220
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit de4b06559119eac499906aaa4d42046b3beed52d
Author: Nigel Tao <nigeltao@golang.org>
Date:   Thu Oct 27 13:36:48 2016 +1100

    image/png: allow tRNS chunk without a PLTE chunk.
    
    While https://www.w3.org/TR/PNG/#5ChunkOrdering says that tRNS's
    ordering constraint is "After PLTE; before IDAT", it is legal for a tRNS
    chunk to occur without a PLTE chunk at all, for greyscale and truecolor
    transparency as opposed to palette-based transparency. See
    https://www.w3.org/TR/PNG/#11transinfo
    
    Fixes #17511.
    
    Change-Id: I047b0b01d78a1cda65e00eeac229bb972cda431d
    Reviewed-on: https://go-review.googlesource.com/32139
    Reviewed-by: Rob Pike <r@golang.org>

commit 645e984f39a6cf0ffdf965dc04130d9c7f57e8a4
Author: Andrew Gerrand <adg@golang.org>
Date:   Wed Oct 26 15:37:15 2016 +1100

    doc: s/race/ethnicity/ in the Code of Conduct
    
    As agreed upon by the Code of Conduct working group, "race" may refer to
    an attempt to classify people based on "defining characteristics",
    regardless of how this people view themselves, while "ethnicity" refers
    to how people identify themselves.
    
    The Code of Conduct working group believes that the term "ethnicity"
    will be more comprehensive and inclusive, and will better serve the Go
    community.
    
    Change-Id: I724b72cadb8cf29b4bac8f83017b0303feae3c94
    Reviewed-on: https://go-review.googlesource.com/32133
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

commit e4820bcfed75cdc4cab2181e0f0ab21c282cec65
Author: Chris McGee <sirnewton_01@yahoo.ca>
Date:   Wed Sep 28 21:31:52 2016 -0400

    net: add multicast UDP support for plan9
    
    The new implementation adds listening support on a multicast
    address with plan9 network interfaces.
    
    Fixes #17218
    
    Change-Id: I2c75515e72e120acb71610cd077fddfbf9cf4e29
    Reviewed-on: https://go-review.googlesource.com/29964
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit a7c84668c83c246c142fb4a25a2a6fd52ba0d540
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Wed Oct 26 17:14:35 2016 -0700

    cmd/compile: remove Label type
    
    With the removal of the old backend,
    a Label is just a Node.
    
    Passes toolstash -cmp.
    
    Change-Id: Ia62cb00fbc551efb75a4ed4dc6ed54fca0831dbf
    Reviewed-on: https://go-review.googlesource.com/32216
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit d6dbf3a0d38773b37bd8fa8d64a3f192102e388b
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Thu Apr 21 19:35:26 2016 -0700

    cmd/compile: use List instead of OKEY for OSLICE*
    
    Performance changes are negligible, but that's expected.
    This is a part of a general effort to eliminate OKEY nodes.
    
    Passes toolstash -cmp.
    
    Updates #15350
    
    name       old alloc/op     new alloc/op     delta
    Template       40.6MB ± 0%      40.6MB ± 0%  -0.04%         (p=0.000 n=9+10)
    Unicode        33.4MB ± 0%      33.4MB ± 0%    ~           (p=0.853 n=10+10)
    GoTypes         120MB ± 0%       120MB ± 0%  -0.03%         (p=0.000 n=9+10)
    Compiler        470MB ± 0%       469MB ± 0%  -0.06%        (p=0.000 n=10+10)
    
    name       old allocs/op    new allocs/op    delta
    Template         404k ± 0%        404k ± 0%    ~           (p=0.165 n=10+10)
    Unicode          350k ± 0%        350k ± 0%    ~            (p=0.211 n=9+10)
    GoTypes         1.21M ± 0%       1.21M ± 0%    ~           (p=0.315 n=10+10)
    Compiler        4.35M ± 0%       4.35M ± 0%  -0.03%        (p=0.001 n=10+10)
    
    Change-Id: I17d547bf9568b1ee2514a7ffab930424617f995e
    Reviewed-on: https://go-review.googlesource.com/32213
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 461adfd817eea64ee6b96f5711a48854bcda6241
Author: Klaus Post <klauspost@gmail.com>
Date:   Sat Oct 15 14:37:19 2016 +0200

    compress/flate: make compression level 0 consistent
    
    Tests for determinism was not working as intended since io.Copybuffer
    uses the io.WriterTo if available.
    
    This exposed that level 0 (no compression) changed output
    based on the number of writes and buffers given to the
    writer.
    
    Previously, Write would emit a new raw block (BTYPE=00) for
    every non-empty call to Write.
    
    This CL fixes it such that a raw block is only emitted upon
    the following conditions:
            * A full window is obtained (every 65535 bytes)
            * Flush is called
            * Close is called
    
    Change-Id: I807f866d97e2db7820f11febab30a96266a6cbf1
    Reviewed-on: https://go-review.googlesource.com/31174
    Run-TryBot: Joe Tsai <thebrokentoaster@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Joe Tsai <thebrokentoaster@gmail.com>

commit 2e196b15b94e48009369aae25299a59cbc7d45f4
Author: Klaus Post <klauspost@gmail.com>
Date:   Sat Oct 22 18:50:02 2016 +0200

    compress/flate: level 1 (best speed) match across blocks
    
    This change makes deflate level 1 (best speed) match across
    block boundaries. This comes at a small speed penalty,
    but improves compression on almost all output.
    
    Sample numbers on various content types:
    
    enwik9:            391052014 ->  382578469 bytes, 77.59 -> 74.28 MB/s
    adresser.001:       57269799 ->   47756095 bytes, 287.84 -> 357.86 MB/s
    10gb:             5233055166 -> 5198328382 bytes, 105.85 -> 96.99 MB/s
    rawstudio-mint14: 3972329211 -> 3927423364 bytes, 100.07 -> 94.22 MB/s
    sites:             165556800 ->  163178702 bytes, 72.31 -> 70.15 MB/s
    objectfiles:       115962472 ->  111649524 bytes, 132.60 -> 128.05 MB/s
    sharnd.out:        200015283 ->  200015283 bytes, 221.50 -> 218.83 MB/s
    
    Change-Id: I62a139e5c06976e803439a4268acede5139b8cfc
    Reviewed-on: https://go-review.googlesource.com/31640
    Reviewed-by: Joe Tsai <thebrokentoaster@gmail.com>
    Reviewed-by: Nigel Tao <nigeltao@golang.org>

commit f8a3444388a223eb4db9df61c07fd15e142e7044
Author: Hiroshi Ioka <hirochachacha@gmail.com>
Date:   Wed Oct 26 11:44:26 2016 +0900

    cmd/compile/internal/gc: remove EscScope
    
    EscScope behaves like EscHeap in current code.
    There are no need to handle it specially.
    So remove it and use EscHeap instead.
    
    Change-Id: I910106fd147f00e5f4fd52c7dde05128141a5160
    Reviewed-on: https://go-review.googlesource.com/32130
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit 1e6b12a201e5fa7009510bb036367dfb0f5a6320
Author: Bill O'Farrell <billo@ca.ibm.com>
Date:   Wed Oct 26 18:35:12 2016 -0400

    math/big: uses SIMD for some math big functions on s390x
    
    The following benchmarks are improved by the amounts shown
    (Others unaffected beyond the level of noise.)
    Also adds a test to confirm non-SIMD implementation still correct,
    even when run on SIMD-capable machine
    
    Benchmark                   old            new
    BenchmarkAddVV/100-18    66148.08 MB/s 117546.19 MB/s 1.8x
    BenchmarkAddVV/1000-18   70168.27 MB/s 133478.96 MB/s 1.9x
    BenchmarkAddVV/10000-18  67489.80 MB/s 100010.79 MB/s 1.5x
    BenchmarkAddVV/100000-18 54329.99 MB/s  69232.45 MB/s 1.3x
    BenchmarkAddVW/100-18     9929.10 MB/s  14841.31 MB/s 1.5x
    BenchmarkAddVW/1000-18   10583.31 MB/s  18674.44 MB/s 1.76x
    BenchmarkAddVW/10000-18  10521.15 MB/s  17484.10 MB/s 1.66x
    BenchmarkAddVW/100000-18 10616.56 MB/s  18084.27 MB/s 1.7x
    
    Change-Id: Ic9234c41a43f6c5e9d0e9377de8b4deeefc428a7
    Reviewed-on: https://go-review.googlesource.com/32211
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 829aa6732a47db75dbb649837fa888030659ccf9
Author: Ben Burkert <ben@benburkert.com>
Date:   Mon Oct 17 14:47:48 2016 -0700

    crypto/tls: add CloseWrite method to Conn
    
    The CloseWrite method sends a close_notify alert record to the other
    side of the connection. This record indicates that the sender has
    finished sending on the connection. Unlike the Close method, the sender
    may still read from the connection until it recieves a close_notify
    record (or the underlying connection is closed). This is analogous to a
    TCP half-close.
    
    This is a rework of CL 25159 with fixes for the unstable test.
    
    Updates #8579
    
    Change-Id: I47608d2f82a88baff07a90fd64c280ed16a60d5e
    Reviewed-on: https://go-review.googlesource.com/31318
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 8eca08611ac1c65622400f526ab5b9065a4c9d67
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Wed Oct 26 14:31:48 2016 -0700

    unicode/utf8: optimize ValidRune
    
    Re-writing the switch statement as a single boolean expression
    reduces the number of branches that the compiler generates.
    It is also arguably easier to read as a pair of numeric ranges
    that valid runes can exist in.
    
    No test changes since the existing test does a good job of
    testing all of the boundaries.
    
    This change was to gain back some performance after a correctness
    fix done in http://golang.org/cl/32123.
    
    The correctness fix (CL/32123) slowed down the benchmarks slightly:
            benchmark                   old ns/op     new ns/op     delta
            BenchmarkIndexRune/10-4     19.3          21.6          +11.92%
            BenchmarkIndexRune/32-4     33.6          35.2          +4.76%
    
    Since the fix relies on utf8.ValidRune, this CL improves benchmarks:
            benchmark                   old ns/op     new ns/op     delta
            BenchmarkIndexRune/10-4     21.6          20.0          -7.41%
            BenchmarkIndexRune/32-4     35.2          33.5          -4.83%
    
    Change-Id: Ib1ca10a2e29c90e879a8ef9b7221c33e85d015d8
    Reviewed-on: https://go-review.googlesource.com/32122
    Run-TryBot: Joe Tsai <thebrokentoaster@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 3cfc757c625d8f9fabf2c52e2ae3a8eab3fbdf61
Author: Robert Griesemer <gri@golang.org>
Date:   Wed Oct 26 15:52:56 2016 -0700

    go/scanner: recognize invalid floating-point constant exponent
    
    Fixes #17621.
    
    Change-Id: Id3e75c9b7fba2cf8e791c8817f890556ca238e9d
    Reviewed-on: https://go-review.googlesource.com/32096
    Reviewed-by: Josh Bleecher Snyder <josharian@gmail.com>

commit 4b2665786ec13c82ab751cd2d4312772b80cef12
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Wed Oct 26 14:18:37 2016 -0700

    bytes, strings: fix regression in IndexRune
    
    In all previous versions of Go, the behavior of IndexRune(s, r)
    where r was utf.RuneError was that it would effectively return the
    index of any invalid UTF-8 byte sequence (include RuneError).
    Optimizations made in http://golang.org/cl/28537 and
    http://golang.org/cl/28546 altered this undocumented behavior such
    that RuneError would only match on the RuneError rune itself.
    
    Although, the new behavior is arguably reasonable, it did break code
    that depended on the previous behavior. Thus, we add special checks
    to ensure that we preserve the old behavior.
    
    There is a slight performance hit for correctness:
            benchmark                   old ns/op     new ns/op     delta
            BenchmarkIndexRune/10-4     19.3          21.6          +11.92%
            BenchmarkIndexRune/32-4     33.6          35.2          +4.76%
    This only occurs on small strings. The performance hit for larger strings
    is neglible and not shown.
    
    Fixes #17611
    
    Change-Id: I1d863a741213d46c40b2e1724c41245df52502a5
    Reviewed-on: https://go-review.googlesource.com/32123
    Run-TryBot: Joe Tsai <thebrokentoaster@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 4f1e7be51f401a5374c0def2df0773abc924b03c
Author: Adam Langley <agl@golang.org>
Date:   Wed Oct 26 13:51:44 2016 -0700

    crypto/x509: use Certificate.Equals and CertPool.contains.
    
    By using these utility functions, the code can be made a little shorter.
    Thanks to Omar Shafie for pointing this out in
    https://golang.org/cl/27393/.
    
    Change-Id: I33fd97cf7d60a31d0844ec16c12bba530dcc6f6d
    Reviewed-on: https://go-review.googlesource.com/32120
    Run-TryBot: Adam Langley <agl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit f697cf22558157b9c0bc287287c5668c758f16c9
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Wed Oct 26 22:49:13 2016 +0000

    net/http/httptest: doc tweaks
    
    From lost-in-flight comments on CL 32190.
    
    Change-Id: I2029cbac6d24b5944a796b359080011ec3a8da92
    Reviewed-on: https://go-review.googlesource.com/32210
    Reviewed-by: Caleb Spare <cespare@gmail.com>
    Reviewed-by: Martin Möhrmann <martisch@uos.de>

commit 8e4ea2f5e8ee2b9c455adb329d96fb13cd3c64da
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Wed Oct 26 22:34:40 2016 +0000

    net/http/httptest: add more docs on ResponseRecord fields
    
    Fixes #16717
    
    Change-Id: I7b6518609796a537437539c35461a18e9e6f207f
    Reviewed-on: https://go-review.googlesource.com/32190
    Reviewed-by: Martin Möhrmann <martisch@uos.de>

commit 31f50643c36b3d2a74cf4f8df3a943bbbc06dafe
Author: Jaana Burcu Dogan <jbd@google.com>
Date:   Tue Oct 25 14:10:47 2016 -0700

    context: add comments to the WithCancel example, apply minor improvements
    
    Fixes #17534.
    
    Change-Id: I28af74b287a5a09d5f6607a012f3d5d133b04ed2
    Reviewed-on: https://go-review.googlesource.com/32017
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 117c9c35cde8444d26db91bfa8346dde252989b1
Author: Carl Johnson <me@carlmjohnson.net>
Date:   Tue Oct 25 22:35:01 2016 -0400

    net/http: Improve docs for Response.ParseForm
    
    - Removes a subject-verb disagreement.
    - Documents that PATCH requests also populate PostForm.
    - Explains that r.PostForm is always set (but blank for GET etc.).
    
    Fixes #16609
    
    Change-Id: I6b4693f8eb6db7c66fd9b9cd1df8927f50d46d50
    Reviewed-on: https://go-review.googlesource.com/32091
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit 03361fd350d4e3b53093bced838504b77e8775c7
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Wed Oct 26 13:20:05 2016 -0700

    bytes, strings: fix snake-case in variable name
    
    Change-Id: I40896fffbffefa359d08abda346933aa996f628d
    Reviewed-on: https://go-review.googlesource.com/32124
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit d80e8de54ec633d018ccef94b67c796dda4e1944
Author: Than McIntosh <thanm@google.com>
Date:   Mon Oct 24 13:05:10 2016 -0400

    cmd/compile: avoid truncating fieldname var locations
    
    Don't include package path when creating LSyms for auto and param
    variables during Prog generation, and update the DWARF emit routine
    accordingly (remove the code that chops off package path from names in
    DWARF var location expressions). Implementation suggested by mdempsky@.
    
    The intent of this change is to have saner location expressions in cases
    where the variable corresponds to a structure field. For example, the
    SSA compiler's "decompose" phase can take a slice value and break it
    apart into three scalar variables corresponding to the fields (slice "X"
    gets split into "X.len", "X.cap", "X.ptr"). In such cases we want the
    name in the location expression to omit the package path but preserve
    the original variable name (e.g. "X").
    
    Fixes #16338
    
    Change-Id: Ibc444e7f3454b70fc500a33f0397e669d127daa1
    Reviewed-on: https://go-review.googlesource.com/31819
    Run-TryBot: Than McIntosh <thanm@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

commit c7e0dda45046c539d99b7e8c3bd3e79b3fab9776
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Sun Oct 23 06:04:14 2016 -0700

    net/http: add Server.ReadHeaderTimeout, IdleTimeout, document WriteTimeout
    
    Updates #14204
    Updates #16450
    Updates #16100
    
    Change-Id: Ic283bcec008a8e0bfbcfd8531d30fffe71052531
    Reviewed-on: https://go-review.googlesource.com/32024
    Reviewed-by: Tom Bergan <tombergan@google.com>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 1625da24106b610f89ff7a67a11581df95f8e234
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Sun Apr 10 10:16:41 2016 -0700

    encoding/json: marshal the RawMessage value type the same as its pointer type
    
    Fixes #14493
    Updates #6458 (changes its behavior)
    
    Change-Id: I851a8113fd312dae3384e989ec2b70949dc22838
    Reviewed-on: https://go-review.googlesource.com/21811
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 587b80322c6ce34ab115d7a837a56d7450aa913d
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Wed Oct 26 18:58:01 2016 +0000

    api: update next.txt
    
    Change-Id: I5ad338c90c311bd4cfdcd3d221a1f3e506a97d53
    Reviewed-on: https://go-review.googlesource.com/32118
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit bea5252a13f723e08c1cb109cb87105e3bdd4ed0
Author: David Chase <drchase@google.com>
Date:   Fri Oct 21 12:01:52 2016 -0400

    cmd/compile: add explicit 'where' to EscStep data for explanations
    
    Sometimes neither the src nor the dst of an escape edge
    contains the line number appropriate to the edge, so add
    a field so that can be set correctly.
    
    Also updated some of the explanations to be less jargon-y
    and perhaps more informative, and folded bug example into
    test.
    
    Cleaned up some of the function/method names in esc.go
    and did a quick sanity check that each "bundling" function
    was actually called often enough to justify its existence.
    
    Fixes #17459.
    
    Change-Id: Ieba53ab0a6ba1f7a6c4962bc0b702ede9cc3a3cc
    Reviewed-on: https://go-review.googlesource.com/31660
    Run-TryBot: David Chase <drchase@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 6d9c8c926da3abd33e3ec229a8ccd028c7610dc3
Author: Mikio Hara <mikioh.mikioh@gmail.com>
Date:   Thu Oct 27 02:58:09 2016 +0900

    net/http: gofmt -w -s
    
    Change-Id: I6815a8560dd9fe0a0ebd485a0693f7044ba09848
    Reviewed-on: https://go-review.googlesource.com/32137
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit d6625caf5397a52edc38e19d523a597b531a5f12
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 24 14:20:07 2016 -0400

    runtime: scan mark worker stacks like normal
    
    Currently, markroot delays scanning mark worker stacks until mark
    termination by putting the mark worker G directly on the rescan list
    when it encounters one during the mark phase. Without this, since mark
    workers are non-preemptible, two mark workers that attempt to scan
    each other's stacks can deadlock.
    
    However, this is annoyingly asymmetric and causes some real problems.
    First, markroot does not own the G at that point, so it's not
    technically safe to add it to the rescan list. I haven't been able to
    find a specific problem this could cause, but I suspect it's the root
    cause of issue #17099. Second, this will interfere with the hybrid
    barrier, since there is no stack rescanning during mark termination
    with the hybrid barrier.
    
    This commit switches to a different approach. We move the mark
    worker's call to gcDrain to the system stack and set the mark worker's
    status to _Gwaiting for the duration of the drain to indicate that
    it's preemptible. This lets another mark worker scan its G stack while
    the drain is running on the system stack. We don't return to the G
    stack until we can switch back to _Grunning, which ensures we don't
    race with a stack scan. This lets us eliminate the special case for
    mark worker stack scans and scan them just like any other goroutine.
    The only subtlety to this approach is that we have to disable stack
    shrinking for mark workers; they could be referring to captured
    variables from the G stack, so it's not safe to move their stacks.
    
    Updates #17099 and #17503.
    
    Change-Id: Ia5213949ec470af63e24dfce01df357c12adbbea
    Reviewed-on: https://go-review.googlesource.com/31820
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 8e4e103a00c88f297b7f28360d3d021a2e5bb865
Author: David du Colombier <0intro@gmail.com>
Date:   Wed Oct 26 08:50:23 2016 +0200

    net/rpc: enable TestGobError on Plan 9
    
    This issue has been fixed in CL 31271.
    
    Fixes #8908.
    
    Change-Id: I8015490e2d992e09c664560e42188315e0e0669e
    Reviewed-on: https://go-review.googlesource.com/32150
    Run-TryBot: David du Colombier <0intro@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit f46324cffbf87b0a6334e09f72e5f73fb79f5a73
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 25 20:38:20 2016 -0400

    cmd/compile: remove unused writebarrierptr, typedmemmove Nodes
    
    Now that SSA's write barrier pass is generating calls to these,
    compile doesn't need to look them up.
    
    Change-Id: Ib50e5f2c67b247ca280d467c399e23877988bc12
    Reviewed-on: https://go-review.googlesource.com/32170
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit a0cf021be5828f8726380f8fd10070eff30852ba
Author: David du Colombier <0intro@gmail.com>
Date:   Wed Oct 26 18:03:32 2016 +0200

    os: consider only files from #M as regular on Plan 9
    
    TestRemoveDevNull was added in CL 31657. However, this test
    was failing on Plan 9, because /dev/null was considered as
    a regular file.
    
    On Plan 9, there is no special mode to distinguish between
    device files and regular files.
    
    However, files are served by different servers. For example,
    /dev/null is served by #c (devcons), while /bin/cat is served
    by #M (devmnt).
    
    We chose to consider only the files served by #M as regular
    files. All files served by different servers will be considered
    as device files.
    
    Fixes #17598.
    
    Change-Id: Ibb1c3357d742cf2a7de15fc78c9e436dc31982bb
    Reviewed-on: https://go-review.googlesource.com/32152
    Reviewed-by: Russ Cox <rsc@golang.org>
    Run-TryBot: David du Colombier <0intro@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

commit 49543695c56486d6a941e55520b37a9d098d3379
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 20 15:05:51 2016 -0400

    flag: arrange for FlagSet.Usage to be non-nil by default
    
    This allows callers to invoke f.Usage() themselves and get the default
    usage handler instead of a panic (from calling a nil function).
    
    Fixes #16955.
    
    Change-Id: Ie337fd9e1f85daf78c5eae7b5c41d5ad8c1f89bf
    Reviewed-on: https://go-review.googlesource.com/31576
    Run-TryBot: Russ Cox <rsc@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>

commit f9027d61ab48154e4cb29c50e356a3f462840e01
Author: Rob Pike <r@golang.org>
Date:   Tue Oct 25 19:19:39 2016 -0700

    all: freeze net/rpc and reword the 'frozen' message in other frozen packages
    
    Make the messages grammatically korrect and consistent.
    
    Fixes #16844
    
    Change-Id: I7c137b4dc25c0c875ed07b0c64c67ae984c39cbc
    Reviewed-on: https://go-review.googlesource.com/32112
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

commit cec84f7309f9ae962a326d60f19c9c7881749012
Author: Rob Pike <r@golang.org>
Date:   Tue Oct 25 19:14:20 2016 -0700

    doc/effectivego: reword confusing sentence
    
    For some reason git won't let me write
    
            doc/effective_go.html: reword confusing sentence
    
    or even
    
            doc/effective_go: reword confusing sentence
    
    as the subject line for this CL, but that's not important. The
    actual CL just rewrites one sentence and adds an option to grep in
    the associated example.
    
    Fixes #15875
    
    Change-Id: Iee159ea751caf4b73eacf3dfc86e29032646373f
    Reviewed-on: https://go-review.googlesource.com/32110
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

commit 3193c71c5b97c1e770f587f50824b266f04b71d8
Author: Austin Clements <austin@google.com>
Date:   Sun Oct 23 21:53:44 2016 -0400

    runtime: fix bad pointer with 0 stack barriers
    
    Currently, if the number of stack barriers for a stack is 0, we'll
    create a zero-length slice that points just past the end of the stack
    allocation. This bad pointer causes GC panics.
    
    Fix this by creating a nil slice if the stack barrier count is 0.
    
    In practice, the only way this can happen is if
    GODEBUG=gcstackbarrieroff=1 is set because even the minimum size stack
    reserves space for two stack barriers.
    
    Change-Id: I3527c9a504c445b64b81170ee285a28594e7983d
    Reviewed-on: https://go-review.googlesource.com/31762
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit d1cc83472d611a17513795676d650276f823cafd
Author: Austin Clements <austin@google.com>
Date:   Mon Oct 3 16:18:17 2016 -0400

    runtime: debug code to panic when marking a free object
    
    This adds debug code enabled in gccheckmark mode that panics if we
    attempt to mark an unallocated object. This is a common issue with the
    hybrid barrier when we're manipulating uninitialized memory that
    contains stale pointers. This also tends to catch bugs that will lead
    to "sweep increased allocation count" crashes closer to the source of
    the bug.
    
    Change-Id: I443ead3eac6f316a46f50b106078b524cac317f4
    Reviewed-on: https://go-review.googlesource.com/31761
    Reviewed-by: Rick Hudson <rlh@golang.org>

commit 79561a84ceb4435c1294767d26b0b8a0dd77809d
Author: Austin Clements <austin@google.com>
Date:   Thu Oct 20 22:45:18 2016 -0400

    runtime: simplify reflectcall write barriers
    
    Currently reflectcall has a subtle dance with write barriers where the
    assembly code copies the result values from the stack to the in-heap
    argument frame without write barriers and then calls into the runtime
    after the fact to invoke the necessary write barriers.
    
    For the hybrid barrier (and for ROC), we need to switch to a
    *pre*-write write barrier, which is very difficult to do with the
    current setup. We could tie ourselves in knots of subtle reasoning
    about why it's okay in this particular case to have a post-write write
    barrier, but this commit instead takes a different approach. Rather
    than making things more complex, this simplifies reflection calls so
    that the argument copy is done in Go using normal bulk write barriers.
    
    The one difficulty with this approach is that calling into Go requires
    putting arguments on the stack, but the call* functions "donate" their
    entire stack frame to the called function. We can get away with this
    now because the copy avoids using the stack and has copied the results
    out before we clobber the stack frame to call into the write barrier.
    The solution in this CL is to call another function, passing arguments
    in registers instead of on the stack, and let that other function
    reserve more stack space and setup the arguments for the runtime.
    
    This approach seemed to work out the best. I also tried making the
    call* functions reserve 32 extra bytes of frame for the write barrier
    arguments and adjust SP up by 32 bytes around the call. However, even
    with the necessary changes to the assembler to correct the spdelta
    table, the runtime was still having trouble with the frame layout (and
    the changes to the assembler caused many other things that do strange
    things with the SP to fail to assemble). The approach I took doesn't
    require any funny business with the SP.
    
    Updates #17503.
    
    Change-Id: Ie2bb0084b24d6cff38b5afb218b9e0534ad2119e
    Reviewed-on: https://go-review.googlesource.com/31655
    Run-TryBot: Austin Clements <austin@google.com>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

commit 1c3ab3d4312ec67d6450562bd750bb2c77621a66
Author: Russ Cox <rsc@golang.org>
Date:   Fri Oct 21 12:41:15 2016 -0400

    cmd/go: report missing vendor visibility error
    
    The logic for saving the list of packages was not always
    preferring to keep error messages around correctly.
    The missed error led to an internal consistency failure later.
    
    Fixes #17119.
    
    Change-Id: I9723b5d2518c25e2cac5249e6a7b907be95b521c
    Reviewed-on: https://go-review.googlesource.com/31812
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 51c959b62cbc97a41157a5644f5e010b4e39acc8
Author: Filippo Valsorda <hi@filippo.io>
Date:   Wed Oct 19 15:21:54 2016 +0200

    crypto/tls: expand ClientHelloInfo
    
    Fixes #17430
    
    Change-Id: Ia1c25363d64e3091455ce00644438715aff30a0d
    Reviewed-on: https://go-review.googlesource.com/31391
    Run-TryBot: Adam Langley <agl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Filippo Valsorda <hi@filippo.io>

commit 4b9490ee72c225d4d82cb4896f95c757ee8fef89
Author: Russ Cox <rsc@golang.org>
Date:   Thu Oct 20 15:08:40 2016 -0400

    fmt: document that unexported struct fields don't get the String/Error treatment
    
    Fixes #17409.
    
    Change-Id: Ib49ff4a467431b5c1e6637e5144979cf0bfba489
    Reviewed-on: https://go-review.googlesource.com/31817
    Reviewed-by: Martin Möhrmann <martisch@uos.de>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 59b0e147603e4a3a6170b56e30383a94e157e37a
Author: Russ Cox <rsc@golang.org>
Date:   Fri Oct 21 16:04:41 2016 -0400

    cmd/go: diagnose non-canonical import paths before compilation
    
    If we leave it for compilation sometimes the error appears first
    in derived vendor paths, without any indication where they came from.
    This is better.
    
    $ go1.7 build canonical/d
    cmd/go/testdata/src/canonical/a/a.go:3: non-canonical import path "canonical/a//vendor/c" (should be "canonical/a/vendor/c")
    cmd/go/testdata/src/canonical/a/a.go:3: can't find import: "canonical/a//vendor/c"
    
    $ go build canonical/d
    package canonical/d
            imports canonical/b
            imports canonical/a/: non-canonical import path: "canonical/a/" should be "canonical/a"
    $
    
    Fixes #16954.
    
    Change-Id: I315ccec92a00d98a08c139b3dc4e17dbc640edd0
    Reviewed-on: https://go-review.googlesource.com/31668
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit e3324a4b6640da2dc8d3f086a8ed490aedae7091
Author: Russ Cox <rsc@golang.org>
Date:   Tue Oct 25 15:44:14 2016 -0400

    cmd/vet: diagnose non-space-separated struct tag like `json:"x",xml:"y"`
    
    This is not strictly illegal but it probably should be (too late)
    and doesn't mean what it looks like it means:
    the second key-value pair has the key ",xml".
    
    Fixes #14466.
    
    Change-Id: I174bccc23fd28affeb87f57f77c6591634ade641
    Reviewed-on: https://go-review.googlesource.com/32031
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Rob Pike <r@golang.org>
    Reviewed-by: Quentin Smith <quentin@golang.org>

commit 3202aa7800aeb523a7af2015241f96e9ae46bfbc
Author: Michael Munday <munday@ca.ibm.com>
Date:   Fri Oct 21 08:39:39 2016 -0400

    cmd/compile: improve s390x SSA rules for logical ops
    
    This CL introduces some minor changes to match rules more closely
    to the instructions they are targeting. s390x logical operation
    with immediate instructions typically leave some bits in the
    target register unchanged. This means for example that an XOR
    with -1 requires 2 instructions. It is better in cases such as
    this to create a constant and leave it visible to the compiler
    so that it can be reused rather than hiding it in the assembler.
    
    This CL also tweaks the rules a bit to ensure that constants are
    folded when possible.
    
    Change-Id: I1c6dee31ece00fc3c5fdf6a24f1abbc91dd2db2a
    Reviewed-on: https://go-review.googlesource.com/31754
    Reviewed-by: Keith Randall <khr@golang.org>
```
